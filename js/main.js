(()=>{var Ue=Object.create;var Ne=Object.defineProperty;var Ve=Object.getOwnPropertyDescriptor;var Ge=Object.getOwnPropertyNames;var We=Object.getPrototypeOf,$e=Object.prototype.hasOwnProperty;var qe=(M,S)=>()=>(S||M((S={exports:{}}).exports,S),S.exports);var He=(M,S,N,y)=>{if(S&&typeof S=="object"||typeof S=="function")for(let O of Ge(S))!$e.call(M,O)&&O!==N&&Ne(M,O,{get:()=>S[O],enumerable:!(y=Ve(S,O))||y.enumerable});return M};var Ye=(M,S,N)=>(N=M!=null?Ue(We(M)):{},He(S||!M||!M.__esModule?Ne(N,"default",{value:M,enumerable:!0}):N,M));var Ce=qe((we,Le)=>{(function(S,N){typeof we=="object"&&typeof Le=="object"?Le.exports=N():typeof define=="function"&&define.amd?define([],N):typeof we=="object"?we.nunjucks=N():S.nunjucks=N()})(typeof self<"u"?self:we,function(){return(function(M){var S={};function N(y){if(S[y])return S[y].exports;var O=S[y]={i:y,l:!1,exports:{}};return M[y].call(O.exports,O,O.exports,N),O.l=!0,O.exports}return N.m=M,N.c=S,N.d=function(y,O,v){N.o(y,O)||Object.defineProperty(y,O,{configurable:!1,enumerable:!0,get:v})},N.n=function(y){var O=y&&y.__esModule?function(){return y.default}:function(){return y};return N.d(O,"a",O),O},N.o=function(y,O){return Object.prototype.hasOwnProperty.call(y,O)},N.p="",N(N.s=11)})([(function(M,g,N){"use strict";var y=Array.prototype,O=Object.prototype,v={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","\\":"&#92;"},k=/[&"'<>\\]/g,g=M.exports={};function b(h,w){return O.hasOwnProperty.call(h,w)}g.hasOwnProp=b;function P(h){return v[h]}function K(h,w,I){if(I.Update||(I=new g.TemplateError(I)),I.Update(h),!w){var B=I;I=new Error(B.message),I.name=B.name}return I}g._prettifyError=K;function F(h,w,I){var B,U;h instanceof Error&&(U=h,h=U.name+": "+U.message),Object.setPrototypeOf?(B=new Error(h),Object.setPrototypeOf(B,F.prototype)):(B=this,Object.defineProperty(B,"message",{enumerable:!1,writable:!0,value:h})),Object.defineProperty(B,"name",{value:"Template render error"}),Error.captureStackTrace&&Error.captureStackTrace(B,this.constructor);var J;if(U){var H=Object.getOwnPropertyDescriptor(U,"stack");J=H&&(H.get||function(){return H.value}),J||(J=function(){return U.stack})}else{var oe=new Error(h).stack;J=function(){return oe}}return Object.defineProperty(B,"stack",{get:function(){return J.call(B)}}),Object.defineProperty(B,"cause",{value:U}),B.lineno=w,B.colno=I,B.firstUpdate=!0,B.Update=function(X){var Q="("+(X||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?Q+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(Q+=" [Line "+this.lineno+"]")),Q+=`
 `,this.firstUpdate&&(Q+=" "),this.message=Q+(this.message||""),this.firstUpdate=!1,this},B}Object.setPrototypeOf?Object.setPrototypeOf(F.prototype,Error.prototype):F.prototype=Object.create(Error.prototype,{constructor:{value:F}}),g.TemplateError=F;function E(h){return h.replace(k,P)}g.escape=E;function A(h){return O.toString.call(h)==="[object Function]"}g.isFunction=A;function e(h){return O.toString.call(h)==="[object Array]"}g.isArray=e;function o(h){return O.toString.call(h)==="[object String]"}g.isString=o;function n(h){return O.toString.call(h)==="[object Object]"}g.isObject=n;function f(h){return h?typeof h=="string"?h.split("."):[h]:[]}function u(h){var w=f(h);return function(B){for(var U=B,J=0;J<w.length;J++){var H=w[J];if(b(U,H))U=U[H];else return}return U}}g.getAttrGetter=u;function p(h,w,I){for(var B={},U=A(w)?w:u(w),J=0;J<h.length;J++){var H=h[J],oe=U(H,J);if(oe===void 0&&I===!0)throw new TypeError('groupby: attribute "'+w+'" resolved to undefined');(B[oe]||(B[oe]=[])).push(H)}return B}g.groupBy=p;function i(h){return Array.prototype.slice.call(h)}g.toArray=i;function s(h){var w=[];if(!h)return w;for(var I=h.length,B=i(arguments).slice(1),U=-1;++U<I;)_(B,h[U])===-1&&w.push(h[U]);return w}g.without=s;function l(h,w){for(var I="",B=0;B<w;B++)I+=h;return I}g.repeat=l;function t(h,w,I){if(h!=null){if(y.forEach&&h.forEach===y.forEach)h.forEach(w,I);else if(h.length===+h.length)for(var B=0,U=h.length;B<U;B++)w.call(I,h[B],B,h)}}g.each=t;function r(h,w){var I=[];if(h==null)return I;if(y.map&&h.map===y.map)return h.map(w);for(var B=0;B<h.length;B++)I[I.length]=w(h[B],B);return h.length===+h.length&&(I.length=h.length),I}g.map=r;function a(h,w,I){var B=-1;function U(){B++,B<h.length?w(h[B],B,U,I):I()}U()}g.asyncIter=a;function c(h,w,I){var B=x(h||{}),U=B.length,J=-1;function H(){J++;var oe=B[J];J<U?w(oe,h[oe],J,U,H):I()}H()}g.asyncFor=c;function _(h,w,I){return Array.prototype.indexOf.call(h||[],w,I)}g.indexOf=_;function x(h){var w=[];for(var I in h)b(h,I)&&w.push(I);return w}g.keys=x;function T(h){return x(h).map(function(w){return[w,h[w]]})}g._entries=T;function L(h){return x(h).map(function(w){return h[w]})}g._values=L;function R(h,w){return h=h||{},x(w).forEach(function(I){h[I]=w[I]}),h}g._assign=g.extend=R;function m(h,w){if(e(w)||o(w))return w.indexOf(h)!==-1;if(n(w))return h in w;throw new Error('Cannot use "in" operator to search for "'+h+'" in unexpected types.')}g.inOperator=m}),(function(M,S,N){"use strict";function y(o,n){for(var f=0;f<n.length;f++){var u=n[f];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(o,v(u.key),u)}}function O(o,n,f){return n&&y(o.prototype,n),f&&y(o,f),Object.defineProperty(o,"prototype",{writable:!1}),o}function v(o){var n=k(o,"string");return typeof n=="symbol"?n:String(n)}function k(o,n){if(typeof o!="object"||o===null)return o;var f=o[Symbol.toPrimitive];if(f!==void 0){var u=f.call(o,n||"default");if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(o)}function g(o,n){o.prototype=Object.create(n.prototype),o.prototype.constructor=o,b(o,n)}function b(o,n){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(u,p){return u.__proto__=p,u},b(o,n)}var P=N(16),K=N(0);function F(o,n){return typeof o!="function"||typeof n!="function"?n:function(){var u=this.parent;this.parent=o;var p=n.apply(this,arguments);return this.parent=u,p}}function E(o,n,f){f=f||{},K.keys(f).forEach(function(p){f[p]=F(o.prototype[p],f[p])});var u=(function(p){g(i,p);function i(){return p.apply(this,arguments)||this}return O(i,[{key:"typename",get:function(){return n}}]),i})(o);return K._assign(u.prototype,f),u}var A=(function(){function o(){this.init.apply(this,arguments)}var n=o.prototype;return n.init=function(){},o.extend=function(u,p){return typeof u=="object"&&(p=u,u="anonymous"),E(this,u,p)},O(o,[{key:"typename",get:function(){return this.constructor.name}}]),o})(),e=(function(o){g(n,o);function n(){var u,p;return p=o.call(this)||this,(u=p).init.apply(u,arguments),p}var f=n.prototype;return f.init=function(){},n.extend=function(p,i){return typeof p=="object"&&(i=p,p="anonymous"),E(this,p,i)},O(n,[{key:"typename",get:function(){return this.constructor.name}}]),n})(P);M.exports={Obj:A,EmitterObj:e}}),(function(M,S,N){"use strict";var y=N(0),O=Array.from,v=typeof Symbol=="function"&&Symbol.iterator&&typeof O=="function",k=(function(){function r(c,_){this.variables=Object.create(null),this.parent=c,this.topLevel=!1,this.isolateWrites=_}var a=r.prototype;return a.set=function(_,x,T){var L=_.split("."),R=this.variables,m=this;if(T&&(m=this.resolve(L[0],!0))){m.set(_,x);return}for(var h=0;h<L.length-1;h++){var w=L[h];R[w]||(R[w]={}),R=R[w]}R[L[L.length-1]]=x},a.get=function(_){var x=this.variables[_];return x!==void 0?x:null},a.lookup=function(_){var x=this.parent,T=this.variables[_];return T!==void 0?T:x&&x.lookup(_)},a.resolve=function(_,x){var T=x&&this.isolateWrites?void 0:this.parent,L=this.variables[_];return L!==void 0?this:T&&T.resolve(_)},a.push=function(_){return new r(this,_)},a.pop=function(){return this.parent},r})();function g(r,a,c){return function(){for(var x=arguments.length,T=new Array(x),L=0;L<x;L++)T[L]=arguments[L];var R=F(T),m,h=K(T);if(R>r.length)m=T.slice(0,r.length),T.slice(m.length,R).forEach(function(B,U){U<a.length&&(h[a[U]]=B)}),m.push(h);else if(R<r.length){m=T.slice(0,R);for(var w=R;w<r.length;w++){var I=r[w];m.push(h[I]),delete h[I]}m.push(h)}else m=T;return c.apply(this,m)}}function b(r){return r.__keywords=!0,r}function P(r){return r&&Object.prototype.hasOwnProperty.call(r,"__keywords")}function K(r){var a=r.length;if(a){var c=r[a-1];if(P(c))return c}return{}}function F(r){var a=r.length;if(a===0)return 0;var c=r[a-1];return P(c)?a-1:a}function E(r){if(typeof r!="string")return r;this.val=r,this.length=r.length}E.prototype=Object.create(String.prototype,{length:{writable:!0,configurable:!0,value:0}}),E.prototype.valueOf=function(){return this.val},E.prototype.toString=function(){return this.val};function A(r,a){return r instanceof E?new E(a):a.toString()}function e(r){var a=typeof r;return a==="string"?new E(r):a!=="function"?r:function(_){var x=r.apply(this,arguments);return typeof x=="string"?new E(x):x}}function o(r,a){return r=r??"",a&&!(r instanceof E)&&(r=y.escape(r.toString())),r}function n(r,a,c){if(r==null)throw new y.TemplateError("attempted to output null or undefined value",a+1,c+1);return r}function f(r,a){if(r!=null)return typeof r[a]=="function"?function(){for(var c=arguments.length,_=new Array(c),x=0;x<c;x++)_[x]=arguments[x];return r[a].apply(r,_)}:r[a]}function u(r,a,c,_){if(r){if(typeof r!="function")throw new Error("Unable to call `"+a+"`, which is not a function")}else throw new Error("Unable to call `"+a+"`, which is undefined or falsey");return r.apply(c,_)}function p(r,a,c){var _=a.lookup(c);return _!==void 0?_:r.lookup(c)}function i(r,a,c){return r.lineno?r:new y.TemplateError(r,a,c)}function s(r,a,c,_){if(y.isArray(r)){var x=r.length;y.asyncIter(r,function(L,R,m){switch(a){case 1:c(L,R,x,m);break;case 2:c(L[0],L[1],R,x,m);break;case 3:c(L[0],L[1],L[2],R,x,m);break;default:L.push(R,x,m),c.apply(this,L)}},_)}else y.asyncFor(r,function(L,R,m,h,w){c(L,R,m,h,w)},_)}function l(r,a,c,_){var x=0,T,L;function R(U,J){x++,L[U]=J,x===T&&_(null,L.join(""))}if(y.isArray(r))if(T=r.length,L=new Array(T),T===0)_(null,"");else for(var m=0;m<r.length;m++){var h=r[m];switch(a){case 1:c(h,m,T,R);break;case 2:c(h[0],h[1],m,T,R);break;case 3:c(h[0],h[1],h[2],m,T,R);break;default:h.push(m,T,R),c.apply(this,h)}}else{var w=y.keys(r||{});if(T=w.length,L=new Array(T),T===0)_(null,"");else for(var I=0;I<w.length;I++){var B=w[I];c(B,r[B],I,T,R)}}}function t(r){return typeof r!="object"||r===null||y.isArray(r)?r:v&&Symbol.iterator in r?O(r):r}M.exports={Frame:k,makeMacro:g,makeKeywordArgs:b,numArgs:F,suppressValue:o,ensureDefined:n,memberLookup:f,contextOrFrameLookup:p,callWrap:u,handleError:i,isArray:y.isArray,keys:y.keys,SafeString:E,copySafeness:A,markSafe:e,asyncEach:s,asyncAll:l,inOperator:y.inOperator,fromIterator:t}}),(function(M,S,N){"use strict";function y($,q){for(var te=0;te<q.length;te++){var ee=q[te];ee.enumerable=ee.enumerable||!1,ee.configurable=!0,"value"in ee&&(ee.writable=!0),Object.defineProperty($,v(ee.key),ee)}}function O($,q,te){return q&&y($.prototype,q),te&&y($,te),Object.defineProperty($,"prototype",{writable:!1}),$}function v($){var q=k($,"string");return typeof q=="symbol"?q:String(q)}function k($,q){if(typeof $!="object"||$===null)return $;var te=$[Symbol.toPrimitive];if(te!==void 0){var ee=te.call($,q||"default");if(typeof ee!="object")return ee;throw new TypeError("@@toPrimitive must return a primitive value.")}return(q==="string"?String:Number)($)}function g($,q){$.prototype=Object.create(q.prototype),$.prototype.constructor=$,b($,q)}function b($,q){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ee,ie){return ee.__proto__=ie,ee},b($,q)}var P=N(1),K=P.Obj;function F($,q,te){$ instanceof q&&te.push($),$ instanceof E&&$.findAll(q,te)}var E=(function($){g(q,$);function q(){return $.apply(this,arguments)||this}var te=q.prototype;return te.init=function(ie,le){for(var fe=arguments,ge=this,ke=arguments.length,Me=new Array(ke>2?ke-2:0),xe=2;xe<ke;xe++)Me[xe-2]=arguments[xe];this.lineno=ie,this.colno=le,this.fields.forEach(function(je,De){var Oe=fe[De+2];Oe===void 0&&(Oe=null),ge[je]=Oe})},te.findAll=function(ie,le){var fe=this;return le=le||[],this instanceof e?this.children.forEach(function(ge){return F(ge,ie,le)}):this.fields.forEach(function(ge){return F(fe[ge],ie,le)}),le},te.iterFields=function(ie){var le=this;this.fields.forEach(function(fe){ie(le[fe],fe)})},q})(K),A=(function($){g(q,$);function q(){return $.apply(this,arguments)||this}return O(q,[{key:"typename",get:function(){return"Value"}},{key:"fields",get:function(){return["value"]}}]),q})(E),e=(function($){g(q,$);function q(){return $.apply(this,arguments)||this}var te=q.prototype;return te.init=function(ie,le,fe){$.prototype.init.call(this,ie,le,fe||[])},te.addChild=function(ie){this.children.push(ie)},O(q,[{key:"typename",get:function(){return"NodeList"}},{key:"fields",get:function(){return["children"]}}]),q})(E),o=e.extend("Root"),n=A.extend("Literal"),f=A.extend("Symbol"),u=e.extend("Group"),p=e.extend("Array"),i=E.extend("Pair",{fields:["key","value"]}),s=e.extend("Dict"),l=E.extend("LookupVal",{fields:["target","val"]}),t=E.extend("If",{fields:["cond","body","else_"]}),r=t.extend("IfAsync"),a=E.extend("InlineIf",{fields:["cond","body","else_"]}),c=E.extend("For",{fields:["arr","name","body","else_"]}),_=c.extend("AsyncEach"),x=c.extend("AsyncAll"),T=E.extend("Macro",{fields:["name","args","body"]}),L=T.extend("Caller"),R=E.extend("Import",{fields:["template","target","withContext"]}),m=(function($){g(q,$);function q(){return $.apply(this,arguments)||this}var te=q.prototype;return te.init=function(ie,le,fe,ge,ke){$.prototype.init.call(this,ie,le,fe,ge||new e,ke)},O(q,[{key:"typename",get:function(){return"FromImport"}},{key:"fields",get:function(){return["template","names","withContext"]}}]),q})(E),h=E.extend("FunCall",{fields:["name","args"]}),w=h.extend("Filter"),I=w.extend("FilterAsync",{fields:["name","args","symbol"]}),B=s.extend("KeywordArgs"),U=E.extend("Block",{fields:["name","body"]}),J=E.extend("Super",{fields:["blockName","symbol"]}),H=E.extend("TemplateRef",{fields:["template"]}),oe=H.extend("Extends"),ae=E.extend("Include",{fields:["template","ignoreMissing"]}),X=E.extend("Set",{fields:["targets","value"]}),Q=E.extend("Switch",{fields:["expr","cases","default"]}),V=E.extend("Case",{fields:["cond","body"]}),W=e.extend("Output"),G=E.extend("Capture",{fields:["body"]}),ne=n.extend("TemplateData"),ue=E.extend("UnaryOp",{fields:["target"]}),ce=E.extend("BinOp",{fields:["left","right"]}),ve=ce.extend("In"),d=ce.extend("Is"),C=ce.extend("Or"),D=ce.extend("And"),j=ue.extend("Not"),Y=ce.extend("Add"),z=ce.extend("Concat"),re=ce.extend("Sub"),Z=ce.extend("Mul"),se=ce.extend("Div"),he=ce.extend("FloorDiv"),pe=ce.extend("Mod"),de=ce.extend("Pow"),Re=ue.extend("Neg"),Be=ue.extend("Pos"),Ie=E.extend("Compare",{fields:["expr","ops"]}),Pe=E.extend("CompareOperand",{fields:["expr","type"]}),Te=E.extend("CallExtension",{init:function(q,te,ee,ie){this.parent(),this.extName=q.__name||q,this.prop=te,this.args=ee||new e,this.contentArgs=ie||[],this.autoescape=q.autoescape},fields:["extName","prop","args","contentArgs"]}),Ke=Te.extend("CallExtensionAsync");function _e($,q,te){var ee=$.split(`
`);ee.forEach(function(ie,le){ie&&(te&&le>0||!te)&&process.stdout.write(" ".repeat(q));var fe=le===ee.length-1?"":`
`;process.stdout.write(""+ie+fe)})}function Ee($,q){if(q=q||0,_e($.typename+": ",q),$ instanceof e)_e(`
`),$.children.forEach(function(ie){Ee(ie,q+2)});else if($ instanceof Te)_e($.extName+"."+$.prop+`
`),$.args&&Ee($.args,q+2),$.contentArgs&&$.contentArgs.forEach(function(ie){Ee(ie,q+2)});else{var te=[],ee=null;$.iterFields(function(ie,le){ie instanceof E?te.push([le,ie]):(ee=ee||{},ee[le]=ie)}),ee?_e(JSON.stringify(ee,null,2)+`
`,null,!0):_e(`
`),te.forEach(function(ie){var le=ie[0],fe=ie[1];_e("["+le+"] =>",q+2),Ee(fe,q+4)})}}M.exports={Node:E,Root:o,NodeList:e,Value:A,Literal:n,Symbol:f,Group:u,Array:p,Pair:i,Dict:s,Output:W,Capture:G,TemplateData:ne,If:t,IfAsync:r,InlineIf:a,For:c,AsyncEach:_,AsyncAll:x,Macro:T,Caller:L,Import:R,FromImport:m,FunCall:h,Filter:w,FilterAsync:I,KeywordArgs:B,Block:U,Super:J,Extends:oe,Include:ae,Set:X,Switch:Q,Case:V,LookupVal:l,BinOp:ce,In:ve,Is:d,Or:C,And:D,Not:j,Add:Y,Concat:z,Sub:re,Mul:Z,Div:se,FloorDiv:he,Mod:pe,Pow:de,Neg:Re,Pos:Be,Compare:Ie,CompareOperand:Pe,CallExtension:Te,CallExtensionAsync:Ke,printNodes:Ee}}),(function(M,S){}),(function(M,S,N){"use strict";function y(n,f){n.prototype=Object.create(f.prototype),n.prototype.constructor=n,O(n,f)}function O(n,f){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(p,i){return p.__proto__=i,p},O(n,f)}var v=N(8),k=N(17),g=N(3),b=N(0),P=b.TemplateError,K=N(2),F=K.Frame,E=N(1),A=E.Obj,e={"==":"==","===":"===","!=":"!=","!==":"!==","<":"<",">":">","<=":"<=",">=":">="},o=(function(n){y(f,n);function f(){return n.apply(this,arguments)||this}var u=f.prototype;return u.init=function(i,s){this.templateName=i,this.codebuf=[],this.lastId=0,this.buffer=null,this.bufferStack=[],this._scopeClosers="",this.inBlock=!1,this.throwOnUndefined=s},u.fail=function(i,s,l){throw s!==void 0&&(s+=1),l!==void 0&&(l+=1),new P(i,s,l)},u._pushBuffer=function(){var i=this._tmpid();return this.bufferStack.push(this.buffer),this.buffer=i,this._emit("var "+this.buffer+' = "";'),i},u._popBuffer=function(){this.buffer=this.bufferStack.pop()},u._emit=function(i){this.codebuf.push(i)},u._emitLine=function(i){this._emit(i+`
`)},u._emitLines=function(){for(var i=this,s=arguments.length,l=new Array(s),t=0;t<s;t++)l[t]=arguments[t];l.forEach(function(r){return i._emitLine(r)})},u._emitFuncBegin=function(i,s){this.buffer="output",this._scopeClosers="",this._emitLine("function "+s+"(env, context, frame, runtime, cb) {"),this._emitLine("var lineno = "+i.lineno+";"),this._emitLine("var colno = "+i.colno+";"),this._emitLine("var "+this.buffer+' = "";'),this._emitLine("try {")},u._emitFuncEnd=function(i){i||this._emitLine("cb(null, "+this.buffer+");"),this._closeScopeLevels(),this._emitLine("} catch (e) {"),this._emitLine("  cb(runtime.handleError(e, lineno, colno));"),this._emitLine("}"),this._emitLine("}"),this.buffer=null},u._addScopeLevel=function(){this._scopeClosers+="})"},u._closeScopeLevels=function(){this._emitLine(this._scopeClosers+";"),this._scopeClosers=""},u._withScopedSyntax=function(i){var s=this._scopeClosers;this._scopeClosers="",i.call(this),this._closeScopeLevels(),this._scopeClosers=s},u._makeCallback=function(i){var s=this._tmpid();return"function("+s+(i?","+i:"")+`) {
if(`+s+") { cb("+s+"); return; }"},u._tmpid=function(){return this.lastId++,"t_"+this.lastId},u._templateName=function(){return this.templateName==null?"undefined":JSON.stringify(this.templateName)},u._compileChildren=function(i,s){var l=this;i.children.forEach(function(t){l.compile(t,s)})},u._compileAggregate=function(i,s,l,t){var r=this;l&&this._emit(l),i.children.forEach(function(a,c){c>0&&r._emit(","),r.compile(a,s)}),t&&this._emit(t)},u._compileExpression=function(i,s){this.assertType(i,g.Literal,g.Symbol,g.Group,g.Array,g.Dict,g.FunCall,g.Caller,g.Filter,g.LookupVal,g.Compare,g.InlineIf,g.In,g.Is,g.And,g.Or,g.Not,g.Add,g.Concat,g.Sub,g.Mul,g.Div,g.FloorDiv,g.Mod,g.Pow,g.Neg,g.Pos,g.Compare,g.NodeList),this.compile(i,s)},u.assertType=function(i){for(var s=arguments.length,l=new Array(s>1?s-1:0),t=1;t<s;t++)l[t-1]=arguments[t];l.some(function(r){return i instanceof r})||this.fail("assertType: invalid type: "+i.typename,i.lineno,i.colno)},u.compileCallExtension=function(i,s,l){var t=this,r=i.args,a=i.contentArgs,c=typeof i.autoescape=="boolean"?i.autoescape:!0;if(l||this._emit(this.buffer+" += runtime.suppressValue("),this._emit('env.getExtension("'+i.extName+'")["'+i.prop+'"]('),this._emit("context"),(r||a)&&this._emit(","),r&&(r instanceof g.NodeList||this.fail("compileCallExtension: arguments must be a NodeList, use `parser.parseSignature`"),r.children.forEach(function(x,T){t._compileExpression(x,s),(T!==r.children.length-1||a.length)&&t._emit(",")})),a.length&&a.forEach(function(x,T){if(T>0&&t._emit(","),x){t._emitLine("function(cb) {"),t._emitLine("if(!cb) { cb = function(err) { if(err) { throw err; }}}");var L=t._pushBuffer();t._withScopedSyntax(function(){t.compile(x,s),t._emitLine("cb(null, "+L+");")}),t._popBuffer(),t._emitLine("return "+L+";"),t._emitLine("}")}else t._emit("null")}),l){var _=this._tmpid();this._emitLine(", "+this._makeCallback(_)),this._emitLine(this.buffer+" += runtime.suppressValue("+_+", "+c+" && env.opts.autoescape);"),this._addScopeLevel()}else this._emit(")"),this._emit(", "+c+` && env.opts.autoescape);
`)},u.compileCallExtensionAsync=function(i,s){this.compileCallExtension(i,s,!0)},u.compileNodeList=function(i,s){this._compileChildren(i,s)},u.compileLiteral=function(i){if(typeof i.value=="string"){var s=i.value.replace(/\\/g,"\\\\");s=s.replace(/"/g,'\\"'),s=s.replace(/\n/g,"\\n"),s=s.replace(/\r/g,"\\r"),s=s.replace(/\t/g,"\\t"),s=s.replace(/\u2028/g,"\\u2028"),this._emit('"'+s+'"')}else i.value===null?this._emit("null"):this._emit(i.value.toString())},u.compileSymbol=function(i,s){var l=i.value,t=s.lookup(l);t?this._emit(t):this._emit('runtime.contextOrFrameLookup(context, frame, "'+l+'")')},u.compileGroup=function(i,s){this._compileAggregate(i,s,"(",")")},u.compileArray=function(i,s){this._compileAggregate(i,s,"[","]")},u.compileDict=function(i,s){this._compileAggregate(i,s,"{","}")},u.compilePair=function(i,s){var l=i.key,t=i.value;l instanceof g.Symbol?l=new g.Literal(l.lineno,l.colno,l.value):l instanceof g.Literal&&typeof l.value=="string"||this.fail("compilePair: Dict keys must be strings or names",l.lineno,l.colno),this.compile(l,s),this._emit(": "),this._compileExpression(t,s)},u.compileInlineIf=function(i,s){this._emit("("),this.compile(i.cond,s),this._emit("?"),this.compile(i.body,s),this._emit(":"),i.else_!==null?this.compile(i.else_,s):this._emit('""'),this._emit(")")},u.compileIn=function(i,s){this._emit("runtime.inOperator("),this.compile(i.left,s),this._emit(","),this.compile(i.right,s),this._emit(")")},u.compileIs=function(i,s){var l=i.right.name?i.right.name.value:i.right.value;this._emit('env.getTest("'+l+'").call(context, '),this.compile(i.left,s),i.right.args&&(this._emit(","),this.compile(i.right.args,s)),this._emit(") === true")},u._binOpEmitter=function(i,s,l){this.compile(i.left,s),this._emit(l),this.compile(i.right,s)},u.compileOr=function(i,s){return this._binOpEmitter(i,s," || ")},u.compileAnd=function(i,s){return this._binOpEmitter(i,s," && ")},u.compileAdd=function(i,s){return this._binOpEmitter(i,s," + ")},u.compileConcat=function(i,s){return this._binOpEmitter(i,s,' + "" + ')},u.compileSub=function(i,s){return this._binOpEmitter(i,s," - ")},u.compileMul=function(i,s){return this._binOpEmitter(i,s," * ")},u.compileDiv=function(i,s){return this._binOpEmitter(i,s," / ")},u.compileMod=function(i,s){return this._binOpEmitter(i,s," % ")},u.compileNot=function(i,s){this._emit("!"),this.compile(i.target,s)},u.compileFloorDiv=function(i,s){this._emit("Math.floor("),this.compile(i.left,s),this._emit(" / "),this.compile(i.right,s),this._emit(")")},u.compilePow=function(i,s){this._emit("Math.pow("),this.compile(i.left,s),this._emit(", "),this.compile(i.right,s),this._emit(")")},u.compileNeg=function(i,s){this._emit("-"),this.compile(i.target,s)},u.compilePos=function(i,s){this._emit("+"),this.compile(i.target,s)},u.compileCompare=function(i,s){var l=this;this.compile(i.expr,s),i.ops.forEach(function(t){l._emit(" "+e[t.type]+" "),l.compile(t.expr,s)})},u.compileLookupVal=function(i,s){this._emit("runtime.memberLookup(("),this._compileExpression(i.target,s),this._emit("),"),this._compileExpression(i.val,s),this._emit(")")},u._getNodeName=function(i){switch(i.typename){case"Symbol":return i.value;case"FunCall":return"the return value of ("+this._getNodeName(i.name)+")";case"LookupVal":return this._getNodeName(i.target)+'["'+this._getNodeName(i.val)+'"]';case"Literal":return i.value.toString();default:return"--expression--"}},u.compileFunCall=function(i,s){this._emit("(lineno = "+i.lineno+", colno = "+i.colno+", "),this._emit("runtime.callWrap("),this._compileExpression(i.name,s),this._emit(', "'+this._getNodeName(i.name).replace(/"/g,'\\"')+'", context, '),this._compileAggregate(i.args,s,"[","])"),this._emit(")")},u.compileFilter=function(i,s){var l=i.name;this.assertType(l,g.Symbol),this._emit('env.getFilter("'+l.value+'").call(context, '),this._compileAggregate(i.args,s),this._emit(")")},u.compileFilterAsync=function(i,s){var l=i.name,t=i.symbol.value;this.assertType(l,g.Symbol),s.set(t,t),this._emit('env.getFilter("'+l.value+'").call(context, '),this._compileAggregate(i.args,s),this._emitLine(", "+this._makeCallback(t)),this._addScopeLevel()},u.compileKeywordArgs=function(i,s){this._emit("runtime.makeKeywordArgs("),this.compileDict(i,s),this._emit(")")},u.compileSet=function(i,s){var l=this,t=[];i.targets.forEach(function(r){var a=r.value,c=s.lookup(a);c==null&&(c=l._tmpid(),l._emitLine("var "+c+";")),t.push(c)}),i.value?(this._emit(t.join(" = ")+" = "),this._compileExpression(i.value,s),this._emitLine(";")):(this._emit(t.join(" = ")+" = "),this.compile(i.body,s),this._emitLine(";")),i.targets.forEach(function(r,a){var c=t[a],_=r.value;l._emitLine('frame.set("'+_+'", '+c+", true);"),l._emitLine("if(frame.topLevel) {"),l._emitLine('context.setVariable("'+_+'", '+c+");"),l._emitLine("}"),_.charAt(0)!=="_"&&(l._emitLine("if(frame.topLevel) {"),l._emitLine('context.addExport("'+_+'", '+c+");"),l._emitLine("}"))})},u.compileSwitch=function(i,s){var l=this;this._emit("switch ("),this.compile(i.expr,s),this._emit(") {"),i.cases.forEach(function(t,r){l._emit("case "),l.compile(t.cond,s),l._emit(": "),l.compile(t.body,s),t.body.children.length&&l._emitLine("break;")}),i.default&&(this._emit("default:"),this.compile(i.default,s)),this._emit("}")},u.compileIf=function(i,s,l){var t=this;this._emit("if("),this._compileExpression(i.cond,s),this._emitLine(") {"),this._withScopedSyntax(function(){t.compile(i.body,s),l&&t._emit("cb()")}),i.else_?(this._emitLine(`}
else {`),this._withScopedSyntax(function(){t.compile(i.else_,s),l&&t._emit("cb()")})):l&&(this._emitLine(`}
else {`),this._emit("cb()")),this._emitLine("}")},u.compileIfAsync=function(i,s){this._emit("(function(cb) {"),this.compileIf(i,s,!0),this._emit("})("+this._makeCallback()),this._addScopeLevel()},u._emitLoopBindings=function(i,s,l,t){var r=this,a=[{name:"index",val:l+" + 1"},{name:"index0",val:l},{name:"revindex",val:t+" - "+l},{name:"revindex0",val:t+" - "+l+" - 1"},{name:"first",val:l+" === 0"},{name:"last",val:l+" === "+t+" - 1"},{name:"length",val:t}];a.forEach(function(c){r._emitLine('frame.set("loop.'+c.name+'", '+c.val+");")})},u.compileFor=function(i,s){var l=this,t=this._tmpid(),r=this._tmpid(),a=this._tmpid();if(s=s.push(),this._emitLine("frame = frame.push();"),this._emit("var "+a+" = "),this._compileExpression(i.arr,s),this._emitLine(";"),this._emit("if("+a+") {"),this._emitLine(a+" = runtime.fromIterator("+a+");"),i.name instanceof g.Array){this._emitLine("var "+t+";"),this._emitLine("if(runtime.isArray("+a+")) {"),this._emitLine("var "+r+" = "+a+".length;"),this._emitLine("for("+t+"=0; "+t+" < "+a+".length; "+t+"++) {"),i.name.children.forEach(function(m,h){var w=l._tmpid();l._emitLine("var "+w+" = "+a+"["+t+"]["+h+"];"),l._emitLine('frame.set("'+m+'", '+a+"["+t+"]["+h+"]);"),s.set(i.name.children[h].value,w)}),this._emitLoopBindings(i,a,t,r),this._withScopedSyntax(function(){l.compile(i.body,s)}),this._emitLine("}"),this._emitLine("} else {");var c=i.name.children,_=c[0],x=c[1],T=this._tmpid(),L=this._tmpid();s.set(_.value,T),s.set(x.value,L),this._emitLine(t+" = -1;"),this._emitLine("var "+r+" = runtime.keys("+a+").length;"),this._emitLine("for(var "+T+" in "+a+") {"),this._emitLine(t+"++;"),this._emitLine("var "+L+" = "+a+"["+T+"];"),this._emitLine('frame.set("'+_.value+'", '+T+");"),this._emitLine('frame.set("'+x.value+'", '+L+");"),this._emitLoopBindings(i,a,t,r),this._withScopedSyntax(function(){l.compile(i.body,s)}),this._emitLine("}"),this._emitLine("}")}else{var R=this._tmpid();s.set(i.name.value,R),this._emitLine("var "+r+" = "+a+".length;"),this._emitLine("for(var "+t+"=0; "+t+" < "+a+".length; "+t+"++) {"),this._emitLine("var "+R+" = "+a+"["+t+"];"),this._emitLine('frame.set("'+i.name.value+'", '+R+");"),this._emitLoopBindings(i,a,t,r),this._withScopedSyntax(function(){l.compile(i.body,s)}),this._emitLine("}")}this._emitLine("}"),i.else_&&(this._emitLine("if (!"+r+") {"),this.compile(i.else_,s),this._emitLine("}")),this._emitLine("frame = frame.pop();")},u._compileAsyncLoop=function(i,s,l){var t=this,r=this._tmpid(),a=this._tmpid(),c=this._tmpid(),_=l?"asyncAll":"asyncEach";if(s=s.push(),this._emitLine("frame = frame.push();"),this._emit("var "+c+" = runtime.fromIterator("),this._compileExpression(i.arr,s),this._emitLine(");"),i.name instanceof g.Array){var x=i.name.children.length;this._emit("runtime."+_+"("+c+", "+x+", function("),i.name.children.forEach(function(R){t._emit(R.value+",")}),this._emit(r+","+a+",next) {"),i.name.children.forEach(function(R){var m=R.value;s.set(m,m),t._emitLine('frame.set("'+m+'", '+m+");")})}else{var T=i.name.value;this._emitLine("runtime."+_+"("+c+", 1, function("+T+", "+r+", "+a+",next) {"),this._emitLine('frame.set("'+T+'", '+T+");"),s.set(T,T)}this._emitLoopBindings(i,c,r,a),this._withScopedSyntax(function(){var R;l&&(R=t._pushBuffer()),t.compile(i.body,s),t._emitLine("next("+r+(R?","+R:"")+");"),l&&t._popBuffer()});var L=this._tmpid();this._emitLine("}, "+this._makeCallback(L)),this._addScopeLevel(),l&&this._emitLine(this.buffer+" += "+L+";"),i.else_&&(this._emitLine("if (!"+c+".length) {"),this.compile(i.else_,s),this._emitLine("}")),this._emitLine("frame = frame.pop();")},u.compileAsyncEach=function(i,s){this._compileAsyncLoop(i,s)},u.compileAsyncAll=function(i,s){this._compileAsyncLoop(i,s,!0)},u._compileMacro=function(i,s){var l=this,t=[],r=null,a="macro_"+this._tmpid(),c=s!==void 0;i.args.children.forEach(function(m,h){h===i.args.children.length-1&&m instanceof g.Dict?r=m:(l.assertType(m,g.Symbol),t.push(m))});var _=[].concat(t.map(function(m){return"l_"+m.value}),["kwargs"]),x=t.map(function(m){return'"'+m.value+'"'}),T=(r&&r.children||[]).map(function(m){return'"'+m.key.value+'"'}),L;c?L=s.push(!0):L=new F,this._emitLines("var "+a+" = runtime.makeMacro(","["+x.join(", ")+"], ","["+T.join(", ")+"], ","function ("+_.join(", ")+") {","var callerFrame = frame;","frame = "+(c?"frame.push(true);":"new runtime.Frame();"),"kwargs = kwargs || {};",'if (Object.prototype.hasOwnProperty.call(kwargs, "caller")) {','frame.set("caller", kwargs.caller); }'),t.forEach(function(m){l._emitLine('frame.set("'+m.value+'", l_'+m.value+");"),L.set(m.value,"l_"+m.value)}),r&&r.children.forEach(function(m){var h=m.key.value;l._emit('frame.set("'+h+'", '),l._emit('Object.prototype.hasOwnProperty.call(kwargs, "'+h+'")'),l._emit(' ? kwargs["'+h+'"] : '),l._compileExpression(m.value,L),l._emit(");")});var R=this._pushBuffer();return this._withScopedSyntax(function(){l.compile(i.body,L)}),this._emitLine("frame = "+(c?"frame.pop();":"callerFrame;")),this._emitLine("return new runtime.SafeString("+R+");"),this._emitLine("});"),this._popBuffer(),a},u.compileMacro=function(i,s){var l=this._compileMacro(i),t=i.name.value;s.set(t,l),s.parent?this._emitLine('frame.set("'+t+'", '+l+");"):(i.name.value.charAt(0)!=="_"&&this._emitLine('context.addExport("'+t+'");'),this._emitLine('context.setVariable("'+t+'", '+l+");"))},u.compileCaller=function(i,s){this._emit("(function (){");var l=this._compileMacro(i,s);this._emit("return "+l+";})()")},u._compileGetTemplate=function(i,s,l,t){var r=this._tmpid(),a=this._templateName(),c=this._makeCallback(r),_=l?"true":"false",x=t?"true":"false";return this._emit("env.getTemplate("),this._compileExpression(i.template,s),this._emitLine(", "+_+", "+a+", "+x+", "+c),r},u.compileImport=function(i,s){var l=i.target.value,t=this._compileGetTemplate(i,s,!1,!1);this._addScopeLevel(),this._emitLine(t+".getExported("+(i.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(t)),this._addScopeLevel(),s.set(l,t),s.parent?this._emitLine('frame.set("'+l+'", '+t+");"):this._emitLine('context.setVariable("'+l+'", '+t+");")},u.compileFromImport=function(i,s){var l=this,t=this._compileGetTemplate(i,s,!1,!1);this._addScopeLevel(),this._emitLine(t+".getExported("+(i.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(t)),this._addScopeLevel(),i.names.children.forEach(function(r){var a,c,_=l._tmpid();r instanceof g.Pair?(a=r.key.value,c=r.value.value):(a=r.value,c=a),l._emitLine("if(Object.prototype.hasOwnProperty.call("+t+', "'+a+'")) {'),l._emitLine("var "+_+" = "+t+"."+a+";"),l._emitLine("} else {"),l._emitLine(`cb(new Error("cannot import '`+a+`'")); return;`),l._emitLine("}"),s.set(c,_),s.parent?l._emitLine('frame.set("'+c+'", '+_+");"):l._emitLine('context.setVariable("'+c+'", '+_+");")})},u.compileBlock=function(i){var s=this._tmpid();this.inBlock||this._emit('(parentTemplate ? function(e, c, f, r, cb) { cb(""); } : '),this._emit('context.getBlock("'+i.name.value+'")'),this.inBlock||this._emit(")"),this._emitLine("(env, context, frame, runtime, "+this._makeCallback(s)),this._emitLine(this.buffer+" += "+s+";"),this._addScopeLevel()},u.compileSuper=function(i,s){var l=i.blockName.value,t=i.symbol.value,r=this._makeCallback(t);this._emitLine('context.getSuper(env, "'+l+'", b_'+l+", frame, runtime, "+r),this._emitLine(t+" = runtime.markSafe("+t+");"),this._addScopeLevel(),s.set(t,t)},u.compileExtends=function(i,s){var l=this._tmpid(),t=this._compileGetTemplate(i,s,!0,!1);this._emitLine("parentTemplate = "+t),this._emitLine("for(var "+l+" in parentTemplate.blocks) {"),this._emitLine("context.addBlock("+l+", parentTemplate.blocks["+l+"]);"),this._emitLine("}"),this._addScopeLevel()},u.compileInclude=function(i,s){this._emitLine("var tasks = [];"),this._emitLine("tasks.push("),this._emitLine("function(callback) {");var l=this._compileGetTemplate(i,s,!1,i.ignoreMissing);this._emitLine("callback(null,"+l+");});"),this._emitLine("});");var t=this._tmpid();this._emitLine("tasks.push("),this._emitLine("function(template, callback){"),this._emitLine("template.render(context.getVariables(), frame, "+this._makeCallback(t)),this._emitLine("callback(null,"+t+");});"),this._emitLine("});"),this._emitLine("tasks.push("),this._emitLine("function(result, callback){"),this._emitLine(this.buffer+" += result;"),this._emitLine("callback(null);"),this._emitLine("});"),this._emitLine("env.waterfall(tasks, function(){"),this._addScopeLevel()},u.compileTemplateData=function(i,s){this.compileLiteral(i,s)},u.compileCapture=function(i,s){var l=this,t=this.buffer;this.buffer="output",this._emitLine("(function() {"),this._emitLine('var output = "";'),this._withScopedSyntax(function(){l.compile(i.body,s)}),this._emitLine("return output;"),this._emitLine("})()"),this.buffer=t},u.compileOutput=function(i,s){var l=this,t=i.children;t.forEach(function(r){r instanceof g.TemplateData?r.value&&(l._emit(l.buffer+" += "),l.compileLiteral(r,s),l._emitLine(";")):(l._emit(l.buffer+" += runtime.suppressValue("),l.throwOnUndefined&&l._emit("runtime.ensureDefined("),l.compile(r,s),l.throwOnUndefined&&l._emit(","+i.lineno+","+i.colno+")"),l._emit(`, env.opts.autoescape);
`))})},u.compileRoot=function(i,s){var l=this;s&&this.fail("compileRoot: root node can't have frame"),s=new F,this._emitFuncBegin(i,"root"),this._emitLine("var parentTemplate = null;"),this._compileChildren(i,s),this._emitLine("if(parentTemplate) {"),this._emitLine("parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);"),this._emitLine("} else {"),this._emitLine("cb(null, "+this.buffer+");"),this._emitLine("}"),this._emitFuncEnd(!0),this.inBlock=!0;var t=[],r=i.findAll(g.Block);r.forEach(function(a,c){var _=a.name.value;if(t.indexOf(_)!==-1)throw new Error('Block "'+_+'" defined more than once.');t.push(_),l._emitFuncBegin(a,"b_"+_);var x=new F;l._emitLine("var frame = frame.push(true);"),l.compile(a.body,x),l._emitFuncEnd()}),this._emitLine("return {"),r.forEach(function(a,c){var _="b_"+a.name.value;l._emitLine(_+": "+_+",")}),this._emitLine(`root: root
};`)},u.compile=function(i,s){var l=this["compile"+i.typename];l?l.call(this,i,s):this.fail("compile: Cannot compile node: "+i.typename,i.lineno,i.colno)},u.getCode=function(){return this.codebuf.join("")},f})(A);M.exports={compile:function(f,u,p,i,s){s===void 0&&(s={});var l=new o(i,s.throwOnUndefined),t=(p||[]).map(function(a){return a.preprocess}).filter(function(a){return!!a}),r=t.reduce(function(a,c){return c(a)},f);return l.compile(k.transform(v.parse(r,p,s),u,i)),l.getCode()},Compiler:o}}),(function(M,S,N){"use strict";function y(b,P){b.prototype=Object.create(P.prototype),b.prototype.constructor=b,O(b,P)}function O(b,P){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(F,E){return F.__proto__=E,F},O(b,P)}var v=N(4),k=N(1),g=k.EmitterObj;M.exports=(function(b){y(P,b);function P(){return b.apply(this,arguments)||this}var K=P.prototype;return K.resolve=function(E,A){return v.resolve(v.dirname(E),A)},K.isRelative=function(E){return E.indexOf("./")===0||E.indexOf("../")===0},P})(g)}),(function(M,S,N){"use strict";function y(x,T){x.prototype=Object.create(T.prototype),x.prototype.constructor=x,O(x,T)}function O(x,T){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(R,m){return R.__proto__=m,R},O(x,T)}var v=N(12),k=N(15),g=N(0),b=N(5),P=N(18),K=N(10),F=K.FileSystemLoader,E=K.WebLoader,A=K.PrecompiledLoader,e=N(20),o=N(21),n=N(1),f=n.Obj,u=n.EmitterObj,p=N(2),i=p.handleError,s=p.Frame,l=N(22);function t(x,T,L){v(function(){x(T,L)})}var r={type:"code",obj:{root:function(T,L,R,m,h){try{h(null,"")}catch(w){h(i(w,null,null))}}}},a=(function(x){y(T,x);function T(){return x.apply(this,arguments)||this}var L=T.prototype;return L.init=function(m,h){var w=this;h=this.opts=h||{},this.opts.dev=!!h.dev,this.opts.autoescape=h.autoescape!=null?h.autoescape:!0,this.opts.throwOnUndefined=!!h.throwOnUndefined,this.opts.trimBlocks=!!h.trimBlocks,this.opts.lstripBlocks=!!h.lstripBlocks,this.loaders=[],m?this.loaders=g.isArray(m)?m:[m]:F?this.loaders=[new F("views")]:E&&(this.loaders=[new E("/views")]),typeof window<"u"&&window.nunjucksPrecompiled&&this.loaders.unshift(new A(window.nunjucksPrecompiled)),this._initLoaders(),this.globals=o(),this.filters={},this.tests={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],g._entries(P).forEach(function(I){var B=I[0],U=I[1];return w.addFilter(B,U)}),g._entries(e).forEach(function(I){var B=I[0],U=I[1];return w.addTest(B,U)})},L._initLoaders=function(){var m=this;this.loaders.forEach(function(h){h.cache={},typeof h.on=="function"&&(h.on("update",function(w,I){h.cache[w]=null,m.emit("update",w,I,h)}),h.on("load",function(w,I){m.emit("load",w,I,h)}))})},L.invalidateCache=function(){this.loaders.forEach(function(m){m.cache={}})},L.addExtension=function(m,h){return h.__name=m,this.extensions[m]=h,this.extensionsList.push(h),this},L.removeExtension=function(m){var h=this.getExtension(m);h&&(this.extensionsList=g.without(this.extensionsList,h),delete this.extensions[m])},L.getExtension=function(m){return this.extensions[m]},L.hasExtension=function(m){return!!this.extensions[m]},L.addGlobal=function(m,h){return this.globals[m]=h,this},L.getGlobal=function(m){if(typeof this.globals[m]>"u")throw new Error("global not found: "+m);return this.globals[m]},L.addFilter=function(m,h,w){var I=h;return w&&this.asyncFilters.push(m),this.filters[m]=I,this},L.getFilter=function(m){if(!this.filters[m])throw new Error("filter not found: "+m);return this.filters[m]},L.addTest=function(m,h){return this.tests[m]=h,this},L.getTest=function(m){if(!this.tests[m])throw new Error("test not found: "+m);return this.tests[m]},L.resolveTemplate=function(m,h,w){var I=m.isRelative&&h?m.isRelative(w):!1;return I&&m.resolve?m.resolve(h,w):w},L.getTemplate=function(m,h,w,I,B){var U=this,J=this,H=null;if(m&&m.raw&&(m=m.raw),g.isFunction(w)&&(B=w,w=null,h=h||!1),g.isFunction(h)&&(B=h,h=!1),m instanceof _)H=m;else{if(typeof m!="string")throw new Error("template names must be a string: "+m);for(var oe=0;oe<this.loaders.length;oe++){var ae=this.loaders[oe];if(H=ae.cache[this.resolveTemplate(ae,w,m)],H)break}}if(H)if(h&&H.compile(),B){B(null,H);return}else return H;var X,Q=function(W,G){if(!G&&!W&&!I&&(W=new Error("template not found: "+m)),W)if(B){B(W);return}else throw W;var ne;G?(ne=new _(G.src,U,G.path,h),G.noCache||(G.loader.cache[m]=ne)):ne=new _(r,U,"",h),B?B(null,ne):X=ne};return g.asyncIter(this.loaders,function(V,W,G,ne){function ue(ce,ve){ce?ne(ce):ve?(ve.loader=V,ne(null,ve)):G()}m=J.resolveTemplate(V,w,m),V.async?V.getSource(m,ue):ue(null,V.getSource(m))},Q),X},L.express=function(m){return l(this,m)},L.render=function(m,h,w){g.isFunction(h)&&(w=h,h=null);var I=null;return this.getTemplate(m,function(B,U){if(B&&w)t(w,B);else{if(B)throw B;I=U.render(h,w)}}),I},L.renderString=function(m,h,w,I){g.isFunction(w)&&(I=w,w={}),w=w||{};var B=new _(m,this,w.path);return B.render(h,I)},L.waterfall=function(m,h,w){return k(m,h,w)},T})(u),c=(function(x){y(T,x);function T(){return x.apply(this,arguments)||this}var L=T.prototype;return L.init=function(m,h,w){var I=this;this.env=w||new a,this.ctx=g.extend({},m),this.blocks={},this.exported=[],g.keys(h).forEach(function(B){I.addBlock(B,h[B])})},L.lookup=function(m){return m in this.env.globals&&!(m in this.ctx)?this.env.globals[m]:this.ctx[m]},L.setVariable=function(m,h){this.ctx[m]=h},L.getVariables=function(){return this.ctx},L.addBlock=function(m,h){return this.blocks[m]=this.blocks[m]||[],this.blocks[m].push(h),this},L.getBlock=function(m){if(!this.blocks[m])throw new Error('unknown block "'+m+'"');return this.blocks[m][0]},L.getSuper=function(m,h,w,I,B,U){var J=g.indexOf(this.blocks[h]||[],w),H=this.blocks[h][J+1],oe=this;if(J===-1||!H)throw new Error('no super block available for "'+h+'"');H(m,oe,I,B,U)},L.addExport=function(m){this.exported.push(m)},L.getExported=function(){var m=this,h={};return this.exported.forEach(function(w){h[w]=m.ctx[w]}),h},T})(f),_=(function(x){y(T,x);function T(){return x.apply(this,arguments)||this}var L=T.prototype;return L.init=function(m,h,w,I){if(this.env=h||new a,g.isObject(m))switch(m.type){case"code":this.tmplProps=m.obj;break;case"string":this.tmplStr=m.obj;break;default:throw new Error("Unexpected template object type "+m.type+"; expected 'code', or 'string'")}else if(g.isString(m))this.tmplStr=m;else throw new Error("src must be a string or an object describing the source");if(this.path=w,I)try{this._compile()}catch(B){throw g._prettifyError(this.path,this.env.opts.dev,B)}else this.compiled=!1},L.render=function(m,h,w){var I=this;typeof m=="function"?(w=m,m={}):typeof h=="function"&&(w=h,h=null);var B=!h;try{this.compile()}catch(X){var U=g._prettifyError(this.path,this.env.opts.dev,X);if(w)return t(w,U);throw U}var J=new c(m||{},this.blocks,this.env),H=h?h.push(!0):new s;H.topLevel=!0;var oe=null,ae=!1;return this.rootRenderFunc(this.env,J,H,p,function(X,Q){if(!(ae&&w&&typeof Q<"u"))if(X&&(X=g._prettifyError(I.path,I.env.opts.dev,X),ae=!0),w)B?t(w,X,Q):w(X,Q);else{if(X)throw X;oe=Q}}),oe},L.getExported=function(m,h,w){typeof m=="function"&&(w=m,m={}),typeof h=="function"&&(w=h,h=null);try{this.compile()}catch(U){if(w)return w(U);throw U}var I=h?h.push():new s;I.topLevel=!0;var B=new c(m||{},this.blocks,this.env);this.rootRenderFunc(this.env,B,I,p,function(U){U?w(U,null):w(null,B.getExported())})},L.compile=function(){this.compiled||this._compile()},L._compile=function(){var m;if(this.tmplProps)m=this.tmplProps;else{var h=b.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.opts),w=new Function(h);m=w()}this.blocks=this._getBlocks(m),this.rootRenderFunc=m.root,this.compiled=!0},L._getBlocks=function(m){var h={};return g.keys(m).forEach(function(w){w.slice(0,2)==="b_"&&(h[w.slice(2)]=m[w])}),h},T})(f);M.exports={Environment:a,Template:_}}),(function(M,S,N){"use strict";function y(K,F){K.prototype=Object.create(F.prototype),K.prototype.constructor=K,O(K,F)}function O(K,F){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(A,e){return A.__proto__=e,A},O(K,F)}var v=N(9),k=N(3),g=N(1).Obj,b=N(0),P=(function(K){y(F,K);function F(){return K.apply(this,arguments)||this}var E=F.prototype;return E.init=function(e){this.tokens=e,this.peeked=null,this.breakOnBlocks=null,this.dropLeadingWhitespace=!1,this.extensions=[]},E.nextToken=function(e){var o;if(this.peeked)if(!e&&this.peeked.type===v.TOKEN_WHITESPACE)this.peeked=null;else return o=this.peeked,this.peeked=null,o;if(o=this.tokens.nextToken(),!e)for(;o&&o.type===v.TOKEN_WHITESPACE;)o=this.tokens.nextToken();return o},E.peekToken=function(){return this.peeked=this.peeked||this.nextToken(),this.peeked},E.pushToken=function(e){if(this.peeked)throw new Error("pushToken: can only push one token on between reads");this.peeked=e},E.error=function(e,o,n){if(o===void 0||n===void 0){var f=this.peekToken()||{};o=f.lineno,n=f.colno}return o!==void 0&&(o+=1),n!==void 0&&(n+=1),new b.TemplateError(e,o,n)},E.fail=function(e,o,n){throw this.error(e,o,n)},E.skip=function(e){var o=this.nextToken();return!o||o.type!==e?(this.pushToken(o),!1):!0},E.expect=function(e){var o=this.nextToken();return o.type!==e&&this.fail("expected "+e+", got "+o.type,o.lineno,o.colno),o},E.skipValue=function(e,o){var n=this.nextToken();return!n||n.type!==e||n.value!==o?(this.pushToken(n),!1):!0},E.skipSymbol=function(e){return this.skipValue(v.TOKEN_SYMBOL,e)},E.advanceAfterBlockEnd=function(e){var o;return e||(o=this.peekToken(),o||this.fail("unexpected end of file"),o.type!==v.TOKEN_SYMBOL&&this.fail("advanceAfterBlockEnd: expected symbol token or explicit name to be passed"),e=this.nextToken().value),o=this.nextToken(),o&&o.type===v.TOKEN_BLOCK_END?o.value.charAt(0)==="-"&&(this.dropLeadingWhitespace=!0):this.fail("expected block end in "+e+" statement"),o},E.advanceAfterVariableEnd=function(){var e=this.nextToken();e&&e.type===v.TOKEN_VARIABLE_END?this.dropLeadingWhitespace=e.value.charAt(e.value.length-this.tokens.tags.VARIABLE_END.length-1)==="-":(this.pushToken(e),this.fail("expected variable end"))},E.parseFor=function(){var e=this.peekToken(),o,n;this.skipSymbol("for")?(o=new k.For(e.lineno,e.colno),n="endfor"):this.skipSymbol("asyncEach")?(o=new k.AsyncEach(e.lineno,e.colno),n="endeach"):this.skipSymbol("asyncAll")?(o=new k.AsyncAll(e.lineno,e.colno),n="endall"):this.fail("parseFor: expected for{Async}",e.lineno,e.colno),o.name=this.parsePrimary(),o.name instanceof k.Symbol||this.fail("parseFor: variable name expected for loop");var f=this.peekToken().type;if(f===v.TOKEN_COMMA){var u=o.name;for(o.name=new k.Array(u.lineno,u.colno),o.name.addChild(u);this.skip(v.TOKEN_COMMA);){var p=this.parsePrimary();o.name.addChild(p)}}return this.skipSymbol("in")||this.fail('parseFor: expected "in" keyword for loop',e.lineno,e.colno),o.arr=this.parseExpression(),this.advanceAfterBlockEnd(e.value),o.body=this.parseUntilBlocks(n,"else"),this.skipSymbol("else")&&(this.advanceAfterBlockEnd("else"),o.else_=this.parseUntilBlocks(n)),this.advanceAfterBlockEnd(),o},E.parseMacro=function(){var e=this.peekToken();this.skipSymbol("macro")||this.fail("expected macro");var o=this.parsePrimary(!0),n=this.parseSignature(),f=new k.Macro(e.lineno,e.colno,o,n);return this.advanceAfterBlockEnd(e.value),f.body=this.parseUntilBlocks("endmacro"),this.advanceAfterBlockEnd(),f},E.parseCall=function(){var e=this.peekToken();this.skipSymbol("call")||this.fail("expected call");var o=this.parseSignature(!0)||new k.NodeList,n=this.parsePrimary();this.advanceAfterBlockEnd(e.value);var f=this.parseUntilBlocks("endcall");this.advanceAfterBlockEnd();var u=new k.Symbol(e.lineno,e.colno,"caller"),p=new k.Caller(e.lineno,e.colno,u,o,f),i=n.args.children;i[i.length-1]instanceof k.KeywordArgs||i.push(new k.KeywordArgs);var s=i[i.length-1];return s.addChild(new k.Pair(e.lineno,e.colno,u,p)),new k.Output(e.lineno,e.colno,[n])},E.parseWithContext=function(){var e=this.peekToken(),o=null;return this.skipSymbol("with")?o=!0:this.skipSymbol("without")&&(o=!1),o!==null&&(this.skipSymbol("context")||this.fail("parseFrom: expected context after with/without",e.lineno,e.colno)),o},E.parseImport=function(){var e=this.peekToken();this.skipSymbol("import")||this.fail("parseImport: expected import",e.lineno,e.colno);var o=this.parseExpression();this.skipSymbol("as")||this.fail('parseImport: expected "as" keyword',e.lineno,e.colno);var n=this.parseExpression(),f=this.parseWithContext(),u=new k.Import(e.lineno,e.colno,o,n,f);return this.advanceAfterBlockEnd(e.value),u},E.parseFrom=function(){var e=this.peekToken();this.skipSymbol("from")||this.fail("parseFrom: expected from");var o=this.parseExpression();this.skipSymbol("import")||this.fail("parseFrom: expected import",e.lineno,e.colno);for(var n=new k.NodeList,f;;){var u=this.peekToken();if(u.type===v.TOKEN_BLOCK_END){n.children.length||this.fail("parseFrom: Expected at least one import name",e.lineno,e.colno),u.value.charAt(0)==="-"&&(this.dropLeadingWhitespace=!0),this.nextToken();break}n.children.length>0&&!this.skip(v.TOKEN_COMMA)&&this.fail("parseFrom: expected comma",e.lineno,e.colno);var p=this.parsePrimary();if(p.value.charAt(0)==="_"&&this.fail("parseFrom: names starting with an underscore cannot be imported",p.lineno,p.colno),this.skipSymbol("as")){var i=this.parsePrimary();n.addChild(new k.Pair(p.lineno,p.colno,p,i))}else n.addChild(p);f=this.parseWithContext()}return new k.FromImport(e.lineno,e.colno,o,n,f)},E.parseBlock=function(){var e=this.peekToken();this.skipSymbol("block")||this.fail("parseBlock: expected block",e.lineno,e.colno);var o=new k.Block(e.lineno,e.colno);o.name=this.parsePrimary(),o.name instanceof k.Symbol||this.fail("parseBlock: variable name expected",e.lineno,e.colno),this.advanceAfterBlockEnd(e.value),o.body=this.parseUntilBlocks("endblock"),this.skipSymbol("endblock"),this.skipSymbol(o.name.value);var n=this.peekToken();return n||this.fail("parseBlock: expected endblock, got end of file"),this.advanceAfterBlockEnd(n.value),o},E.parseExtends=function(){var e="extends",o=this.peekToken();this.skipSymbol(e)||this.fail("parseTemplateRef: expected "+e);var n=new k.Extends(o.lineno,o.colno);return n.template=this.parseExpression(),this.advanceAfterBlockEnd(o.value),n},E.parseInclude=function(){var e="include",o=this.peekToken();this.skipSymbol(e)||this.fail("parseInclude: expected "+e);var n=new k.Include(o.lineno,o.colno);return n.template=this.parseExpression(),this.skipSymbol("ignore")&&this.skipSymbol("missing")&&(n.ignoreMissing=!0),this.advanceAfterBlockEnd(o.value),n},E.parseIf=function(){var e=this.peekToken(),o;this.skipSymbol("if")||this.skipSymbol("elif")||this.skipSymbol("elseif")?o=new k.If(e.lineno,e.colno):this.skipSymbol("ifAsync")?o=new k.IfAsync(e.lineno,e.colno):this.fail("parseIf: expected if, elif, or elseif",e.lineno,e.colno),o.cond=this.parseExpression(),this.advanceAfterBlockEnd(e.value),o.body=this.parseUntilBlocks("elif","elseif","else","endif");var n=this.peekToken();switch(n&&n.value){case"elseif":case"elif":o.else_=this.parseIf();break;case"else":this.advanceAfterBlockEnd(),o.else_=this.parseUntilBlocks("endif"),this.advanceAfterBlockEnd();break;case"endif":o.else_=null,this.advanceAfterBlockEnd();break;default:this.fail("parseIf: expected elif, else, or endif, got end of file")}return o},E.parseSet=function(){var e=this.peekToken();this.skipSymbol("set")||this.fail("parseSet: expected set",e.lineno,e.colno);for(var o=new k.Set(e.lineno,e.colno,[]),n;(n=this.parsePrimary())&&(o.targets.push(n),!!this.skip(v.TOKEN_COMMA)););return this.skipValue(v.TOKEN_OPERATOR,"=")?(o.value=this.parseExpression(),this.advanceAfterBlockEnd(e.value)):this.skip(v.TOKEN_BLOCK_END)?(o.body=new k.Capture(e.lineno,e.colno,this.parseUntilBlocks("endset")),o.value=null,this.advanceAfterBlockEnd()):this.fail("parseSet: expected = or block end in set tag",e.lineno,e.colno),o},E.parseSwitch=function(){var e="switch",o="endswitch",n="case",f="default",u=this.peekToken();!this.skipSymbol(e)&&!this.skipSymbol(n)&&!this.skipSymbol(f)&&this.fail('parseSwitch: expected "switch," "case" or "default"',u.lineno,u.colno);var p=this.parseExpression();this.advanceAfterBlockEnd(e),this.parseUntilBlocks(n,f,o);var i=this.peekToken(),s=[],l;do{this.skipSymbol(n);var t=this.parseExpression();this.advanceAfterBlockEnd(e);var r=this.parseUntilBlocks(n,f,o);s.push(new k.Case(i.line,i.col,t,r)),i=this.peekToken()}while(i&&i.value===n);switch(i.value){case f:this.advanceAfterBlockEnd(),l=this.parseUntilBlocks(o),this.advanceAfterBlockEnd();break;case o:this.advanceAfterBlockEnd();break;default:this.fail('parseSwitch: expected "case," "default" or "endswitch," got EOF.')}return new k.Switch(u.lineno,u.colno,p,s,l)},E.parseStatement=function(){var e=this.peekToken(),o;if(e.type!==v.TOKEN_SYMBOL&&this.fail("tag name expected",e.lineno,e.colno),this.breakOnBlocks&&b.indexOf(this.breakOnBlocks,e.value)!==-1)return null;switch(e.value){case"raw":return this.parseRaw();case"verbatim":return this.parseRaw("verbatim");case"if":case"ifAsync":return this.parseIf();case"for":case"asyncEach":case"asyncAll":return this.parseFor();case"block":return this.parseBlock();case"extends":return this.parseExtends();case"include":return this.parseInclude();case"set":return this.parseSet();case"macro":return this.parseMacro();case"call":return this.parseCall();case"import":return this.parseImport();case"from":return this.parseFrom();case"filter":return this.parseFilterStatement();case"switch":return this.parseSwitch();default:if(this.extensions.length)for(var n=0;n<this.extensions.length;n++){var f=this.extensions[n];if(b.indexOf(f.tags||[],e.value)!==-1)return f.parse(this,k,v)}this.fail("unknown block tag: "+e.value,e.lineno,e.colno)}return o},E.parseRaw=function(e){e=e||"raw";for(var o="end"+e,n=new RegExp("([\\s\\S]*?){%\\s*("+e+"|"+o+")\\s*(?=%})%}"),f=1,u="",p=null,i=this.advanceAfterBlockEnd();(p=this.tokens._extractRegex(n))&&f>0;){var s=p[0],l=p[1],t=p[2];t===e?f+=1:t===o&&(f-=1),f===0?(u+=l,this.tokens.backN(s.length-l.length)):u+=s}return new k.Output(i.lineno,i.colno,[new k.TemplateData(i.lineno,i.colno,u)])},E.parsePostfix=function(e){for(var o,n=this.peekToken();n;){if(n.type===v.TOKEN_LEFT_PAREN)e=new k.FunCall(n.lineno,n.colno,e,this.parseSignature());else if(n.type===v.TOKEN_LEFT_BRACKET)o=this.parseAggregate(),o.children.length>1&&this.fail("invalid index"),e=new k.LookupVal(n.lineno,n.colno,e,o.children[0]);else if(n.type===v.TOKEN_OPERATOR&&n.value==="."){this.nextToken();var f=this.nextToken();f.type!==v.TOKEN_SYMBOL&&this.fail("expected name as lookup value, got "+f.value,f.lineno,f.colno),o=new k.Literal(f.lineno,f.colno,f.value),e=new k.LookupVal(n.lineno,n.colno,e,o)}else break;n=this.peekToken()}return e},E.parseExpression=function(){var e=this.parseInlineIf();return e},E.parseInlineIf=function(){var e=this.parseOr();if(this.skipSymbol("if")){var o=this.parseOr(),n=e;e=new k.InlineIf(e.lineno,e.colno),e.body=n,e.cond=o,this.skipSymbol("else")?e.else_=this.parseOr():e.else_=null}return e},E.parseOr=function(){for(var e=this.parseAnd();this.skipSymbol("or");){var o=this.parseAnd();e=new k.Or(e.lineno,e.colno,e,o)}return e},E.parseAnd=function(){for(var e=this.parseNot();this.skipSymbol("and");){var o=this.parseNot();e=new k.And(e.lineno,e.colno,e,o)}return e},E.parseNot=function(){var e=this.peekToken();return this.skipSymbol("not")?new k.Not(e.lineno,e.colno,this.parseNot()):this.parseIn()},E.parseIn=function(){for(var e=this.parseIs();;){var o=this.nextToken();if(!o)break;var n=o.type===v.TOKEN_SYMBOL&&o.value==="not";if(n||this.pushToken(o),this.skipSymbol("in")){var f=this.parseIs();e=new k.In(e.lineno,e.colno,e,f),n&&(e=new k.Not(e.lineno,e.colno,e))}else{n&&this.pushToken(o);break}}return e},E.parseIs=function(){var e=this.parseCompare();if(this.skipSymbol("is")){var o=this.skipSymbol("not"),n=this.parseCompare();e=new k.Is(e.lineno,e.colno,e,n),o&&(e=new k.Not(e.lineno,e.colno,e))}return e},E.parseCompare=function(){for(var e=["==","===","!=","!==","<",">","<=",">="],o=this.parseConcat(),n=[];;){var f=this.nextToken();if(f)if(e.indexOf(f.value)!==-1)n.push(new k.CompareOperand(f.lineno,f.colno,this.parseConcat(),f.value));else{this.pushToken(f);break}else break}return n.length?new k.Compare(n[0].lineno,n[0].colno,o,n):o},E.parseConcat=function(){for(var e=this.parseAdd();this.skipValue(v.TOKEN_TILDE,"~");){var o=this.parseAdd();e=new k.Concat(e.lineno,e.colno,e,o)}return e},E.parseAdd=function(){for(var e=this.parseSub();this.skipValue(v.TOKEN_OPERATOR,"+");){var o=this.parseSub();e=new k.Add(e.lineno,e.colno,e,o)}return e},E.parseSub=function(){for(var e=this.parseMul();this.skipValue(v.TOKEN_OPERATOR,"-");){var o=this.parseMul();e=new k.Sub(e.lineno,e.colno,e,o)}return e},E.parseMul=function(){for(var e=this.parseDiv();this.skipValue(v.TOKEN_OPERATOR,"*");){var o=this.parseDiv();e=new k.Mul(e.lineno,e.colno,e,o)}return e},E.parseDiv=function(){for(var e=this.parseFloorDiv();this.skipValue(v.TOKEN_OPERATOR,"/");){var o=this.parseFloorDiv();e=new k.Div(e.lineno,e.colno,e,o)}return e},E.parseFloorDiv=function(){for(var e=this.parseMod();this.skipValue(v.TOKEN_OPERATOR,"//");){var o=this.parseMod();e=new k.FloorDiv(e.lineno,e.colno,e,o)}return e},E.parseMod=function(){for(var e=this.parsePow();this.skipValue(v.TOKEN_OPERATOR,"%");){var o=this.parsePow();e=new k.Mod(e.lineno,e.colno,e,o)}return e},E.parsePow=function(){for(var e=this.parseUnary();this.skipValue(v.TOKEN_OPERATOR,"**");){var o=this.parseUnary();e=new k.Pow(e.lineno,e.colno,e,o)}return e},E.parseUnary=function(e){var o=this.peekToken(),n;return this.skipValue(v.TOKEN_OPERATOR,"-")?n=new k.Neg(o.lineno,o.colno,this.parseUnary(!0)):this.skipValue(v.TOKEN_OPERATOR,"+")?n=new k.Pos(o.lineno,o.colno,this.parseUnary(!0)):n=this.parsePrimary(),e||(n=this.parseFilter(n)),n},E.parsePrimary=function(e){var o=this.nextToken(),n,f=null;if(o?o.type===v.TOKEN_STRING?n=o.value:o.type===v.TOKEN_INT?n=parseInt(o.value,10):o.type===v.TOKEN_FLOAT?n=parseFloat(o.value):o.type===v.TOKEN_BOOLEAN?o.value==="true"?n=!0:o.value==="false"?n=!1:this.fail("invalid boolean: "+o.value,o.lineno,o.colno):o.type===v.TOKEN_NONE?n=null:o.type===v.TOKEN_REGEX&&(n=new RegExp(o.value.body,o.value.flags)):this.fail("expected expression, got end of file"),n!==void 0?f=new k.Literal(o.lineno,o.colno,n):o.type===v.TOKEN_SYMBOL?f=new k.Symbol(o.lineno,o.colno,o.value):(this.pushToken(o),f=this.parseAggregate()),e||(f=this.parsePostfix(f)),f)return f;throw this.error("unexpected token: "+o.value,o.lineno,o.colno)},E.parseFilterName=function(){for(var e=this.expect(v.TOKEN_SYMBOL),o=e.value;this.skipValue(v.TOKEN_OPERATOR,".");)o+="."+this.expect(v.TOKEN_SYMBOL).value;return new k.Symbol(e.lineno,e.colno,o)},E.parseFilterArgs=function(e){if(this.peekToken().type===v.TOKEN_LEFT_PAREN){var o=this.parsePostfix(e);return o.args.children}return[]},E.parseFilter=function(e){for(;this.skip(v.TOKEN_PIPE);){var o=this.parseFilterName();e=new k.Filter(o.lineno,o.colno,o,new k.NodeList(o.lineno,o.colno,[e].concat(this.parseFilterArgs(e))))}return e},E.parseFilterStatement=function(){var e=this.peekToken();this.skipSymbol("filter")||this.fail("parseFilterStatement: expected filter");var o=this.parseFilterName(),n=this.parseFilterArgs(o);this.advanceAfterBlockEnd(e.value);var f=new k.Capture(o.lineno,o.colno,this.parseUntilBlocks("endfilter"));this.advanceAfterBlockEnd();var u=new k.Filter(o.lineno,o.colno,o,new k.NodeList(o.lineno,o.colno,[f].concat(n)));return new k.Output(o.lineno,o.colno,[u])},E.parseAggregate=function(){var e=this.nextToken(),o;switch(e.type){case v.TOKEN_LEFT_PAREN:o=new k.Group(e.lineno,e.colno);break;case v.TOKEN_LEFT_BRACKET:o=new k.Array(e.lineno,e.colno);break;case v.TOKEN_LEFT_CURLY:o=new k.Dict(e.lineno,e.colno);break;default:return null}for(;;){var n=this.peekToken().type;if(n===v.TOKEN_RIGHT_PAREN||n===v.TOKEN_RIGHT_BRACKET||n===v.TOKEN_RIGHT_CURLY){this.nextToken();break}if(o.children.length>0&&(this.skip(v.TOKEN_COMMA)||this.fail("parseAggregate: expected comma after expression",e.lineno,e.colno)),o instanceof k.Dict){var f=this.parsePrimary();this.skip(v.TOKEN_COLON)||this.fail("parseAggregate: expected colon after dict key",e.lineno,e.colno);var u=this.parseExpression();o.addChild(new k.Pair(f.lineno,f.colno,f,u))}else{var p=this.parseExpression();o.addChild(p)}}return o},E.parseSignature=function(e,o){var n=this.peekToken();if(!o&&n.type!==v.TOKEN_LEFT_PAREN){if(e)return null;this.fail("expected arguments",n.lineno,n.colno)}n.type===v.TOKEN_LEFT_PAREN&&(n=this.nextToken());for(var f=new k.NodeList(n.lineno,n.colno),u=new k.KeywordArgs(n.lineno,n.colno),p=!1;;){if(n=this.peekToken(),!o&&n.type===v.TOKEN_RIGHT_PAREN){this.nextToken();break}else if(o&&n.type===v.TOKEN_BLOCK_END)break;if(p&&!this.skip(v.TOKEN_COMMA))this.fail("parseSignature: expected comma after expression",n.lineno,n.colno);else{var i=this.parseExpression();this.skipValue(v.TOKEN_OPERATOR,"=")?u.addChild(new k.Pair(i.lineno,i.colno,i,this.parseExpression())):f.addChild(i)}p=!0}return u.children.length&&f.addChild(u),f},E.parseUntilBlocks=function(){for(var e=this.breakOnBlocks,o=arguments.length,n=new Array(o),f=0;f<o;f++)n[f]=arguments[f];this.breakOnBlocks=n;var u=this.parse();return this.breakOnBlocks=e,u},E.parseNodes=function(){for(var e,o=[];e=this.nextToken();)if(e.type===v.TOKEN_DATA){var n=e.value,f=this.peekToken(),u=f&&f.value;this.dropLeadingWhitespace&&(n=n.replace(/^\s*/,""),this.dropLeadingWhitespace=!1),f&&(f.type===v.TOKEN_BLOCK_START&&u.charAt(u.length-1)==="-"||f.type===v.TOKEN_VARIABLE_START&&u.charAt(this.tokens.tags.VARIABLE_START.length)==="-"||f.type===v.TOKEN_COMMENT&&u.charAt(this.tokens.tags.COMMENT_START.length)==="-")&&(n=n.replace(/\s*$/,"")),o.push(new k.Output(e.lineno,e.colno,[new k.TemplateData(e.lineno,e.colno,n)]))}else if(e.type===v.TOKEN_BLOCK_START){this.dropLeadingWhitespace=!1;var p=this.parseStatement();if(!p)break;o.push(p)}else if(e.type===v.TOKEN_VARIABLE_START){var i=this.parseExpression();this.dropLeadingWhitespace=!1,this.advanceAfterVariableEnd(),o.push(new k.Output(e.lineno,e.colno,[i]))}else e.type===v.TOKEN_COMMENT?this.dropLeadingWhitespace=e.value.charAt(e.value.length-this.tokens.tags.COMMENT_END.length-1)==="-":this.fail("Unexpected token at top-level: "+e.type,e.lineno,e.colno);return o},E.parse=function(){return new k.NodeList(0,0,this.parseNodes())},E.parseAsRoot=function(){return new k.Root(0,0,this.parseNodes())},F})(g);M.exports={parse:function(F,E,A){var e=new P(v.lex(F,A));return E!==void 0&&(e.extensions=E),e.parseAsRoot()},Parser:P}}),(function(M,S,N){"use strict";var y=N(0),O=` 
	\r\xA0`,v="()[]{}%*-+~/#,:|.<>=!",k="0123456789",g="{%",b="%}",P="{{",K="}}",F="{#",E="#}",A="string",e="whitespace",o="data",n="block-start",f="block-end",u="variable-start",p="variable-end",i="comment",s="left-paren",l="right-paren",t="left-bracket",r="right-bracket",a="left-curly",c="right-curly",_="operator",x="comma",T="colon",L="tilde",R="pipe",m="int",h="float",w="boolean",I="none",B="symbol",U="special",J="regex";function H(ae,X,Q,V){return{type:ae,value:X,lineno:Q,colno:V}}var oe=(function(){function ae(Q,V){this.str=Q,this.index=0,this.len=Q.length,this.lineno=0,this.colno=0,this.in_code=!1,V=V||{};var W=V.tags||{};this.tags={BLOCK_START:W.blockStart||g,BLOCK_END:W.blockEnd||b,VARIABLE_START:W.variableStart||P,VARIABLE_END:W.variableEnd||K,COMMENT_START:W.commentStart||F,COMMENT_END:W.commentEnd||E},this.trimBlocks=!!V.trimBlocks,this.lstripBlocks=!!V.lstripBlocks}var X=ae.prototype;return X.nextToken=function(){var V=this.lineno,W=this.colno,G;if(this.in_code){var ne=this.current();if(this.isFinished())return null;if(ne==='"'||ne==="'")return H(A,this._parseString(ne),V,W);if(G=this._extract(O))return H(e,G,V,W);if((G=this._extractString(this.tags.BLOCK_END))||(G=this._extractString("-"+this.tags.BLOCK_END)))return this.in_code=!1,this.trimBlocks&&(ne=this.current(),ne===`
`?this.forward():ne==="\r"&&(this.forward(),ne=this.current(),ne===`
`?this.forward():this.back())),H(f,G,V,W);if((G=this._extractString(this.tags.VARIABLE_END))||(G=this._extractString("-"+this.tags.VARIABLE_END)))return this.in_code=!1,H(p,G,V,W);if(ne==="r"&&this.str.charAt(this.index+1)==="/"){this.forwardN(2);for(var ue="";!this.isFinished();)if(this.current()==="/"&&this.previous()!=="\\"){this.forward();break}else ue+=this.current(),this.forward();for(var ce=["g","i","m","y"],ve="";!this.isFinished();){var d=ce.indexOf(this.current())!==-1;if(d)ve+=this.current(),this.forward();else break}return H(J,{body:ue,flags:ve},V,W)}else if(v.indexOf(ne)!==-1){this.forward();var C=["==","===","!=","!==","<=",">=","//","**"],D=ne+this.current(),j;switch(y.indexOf(C,D)!==-1&&(this.forward(),ne=D,y.indexOf(C,D+this.current())!==-1&&(ne=D+this.current(),this.forward())),ne){case"(":j=s;break;case")":j=l;break;case"[":j=t;break;case"]":j=r;break;case"{":j=a;break;case"}":j=c;break;case",":j=x;break;case":":j=T;break;case"~":j=L;break;case"|":j=R;break;default:j=_}return H(j,ne,V,W)}else if(G=this._extractUntil(O+v),G.match(/^[-+]?[0-9]+$/))if(this.current()==="."){this.forward();var Y=this._extract(k);return H(h,G+"."+Y,V,W)}else return H(m,G,V,W);else{if(G.match(/^(true|false)$/))return H(w,G,V,W);if(G==="none")return H(I,G,V,W);if(G==="null")return H(I,G,V,W);if(G)return H(B,G,V,W);throw new Error("Unexpected value while parsing: "+G)}}else{var z=this.tags.BLOCK_START.charAt(0)+this.tags.VARIABLE_START.charAt(0)+this.tags.COMMENT_START.charAt(0)+this.tags.COMMENT_END.charAt(0);if(this.isFinished())return null;if((G=this._extractString(this.tags.BLOCK_START+"-"))||(G=this._extractString(this.tags.BLOCK_START)))return this.in_code=!0,H(n,G,V,W);if((G=this._extractString(this.tags.VARIABLE_START+"-"))||(G=this._extractString(this.tags.VARIABLE_START)))return this.in_code=!0,H(u,G,V,W);G="";var re,Z=!1;for(this._matches(this.tags.COMMENT_START)&&(Z=!0,G=this._extractString(this.tags.COMMENT_START));(re=this._extractUntil(z))!==null;)if(G+=re,(this._matches(this.tags.BLOCK_START)||this._matches(this.tags.VARIABLE_START)||this._matches(this.tags.COMMENT_START))&&!Z){if(this.lstripBlocks&&this._matches(this.tags.BLOCK_START)&&this.colno>0&&this.colno<=G.length){var se=G.slice(-this.colno);if(/^\s+$/.test(se)&&(G=G.slice(0,-this.colno),!G.length))return this.nextToken()}break}else if(this._matches(this.tags.COMMENT_END)){if(!Z)throw new Error("unexpected end of comment");G+=this._extractString(this.tags.COMMENT_END);break}else G+=this.current(),this.forward();if(re===null&&Z)throw new Error("expected end of comment, got end of file");return H(Z?i:o,G,V,W)}},X._parseString=function(V){this.forward();for(var W="";!this.isFinished()&&this.current()!==V;){var G=this.current();if(G==="\\"){switch(this.forward(),this.current()){case"n":W+=`
`;break;case"t":W+="	";break;case"r":W+="\r";break;default:W+=this.current()}this.forward()}else W+=G,this.forward()}return this.forward(),W},X._matches=function(V){if(this.index+V.length>this.len)return null;var W=this.str.slice(this.index,this.index+V.length);return W===V},X._extractString=function(V){return this._matches(V)?(this.forwardN(V.length),V):null},X._extractUntil=function(V){return this._extractMatching(!0,V||"")},X._extract=function(V){return this._extractMatching(!1,V)},X._extractMatching=function(V,W){if(this.isFinished())return null;var G=W.indexOf(this.current());if(V&&G===-1||!V&&G!==-1){var ne=this.current();this.forward();for(var ue=W.indexOf(this.current());(V&&ue===-1||!V&&ue!==-1)&&!this.isFinished();)ne+=this.current(),this.forward(),ue=W.indexOf(this.current());return ne}return""},X._extractRegex=function(V){var W=this.currentStr().match(V);return W?(this.forwardN(W[0].length),W):null},X.isFinished=function(){return this.index>=this.len},X.forwardN=function(V){for(var W=0;W<V;W++)this.forward()},X.forward=function(){this.index++,this.previous()===`
`?(this.lineno++,this.colno=0):this.colno++},X.backN=function(V){for(var W=0;W<V;W++)this.back()},X.back=function(){if(this.index--,this.current()===`
`){this.lineno--;var V=this.src.lastIndexOf(`
`,this.index-1);V===-1?this.colno=this.index:this.colno=this.index-V}else this.colno--},X.current=function(){return this.isFinished()?"":this.str.charAt(this.index)},X.currentStr=function(){return this.isFinished()?"":this.str.substr(this.index)},X.previous=function(){return this.str.charAt(this.index-1)},ae})();M.exports={lex:function(X,Q){return new oe(X,Q)},TOKEN_STRING:A,TOKEN_WHITESPACE:e,TOKEN_DATA:o,TOKEN_BLOCK_START:n,TOKEN_BLOCK_END:f,TOKEN_VARIABLE_START:u,TOKEN_VARIABLE_END:p,TOKEN_COMMENT:i,TOKEN_LEFT_PAREN:s,TOKEN_RIGHT_PAREN:l,TOKEN_LEFT_BRACKET:t,TOKEN_RIGHT_BRACKET:r,TOKEN_LEFT_CURLY:a,TOKEN_RIGHT_CURLY:c,TOKEN_OPERATOR:_,TOKEN_COMMA:x,TOKEN_COLON:T,TOKEN_TILDE:L,TOKEN_PIPE:R,TOKEN_INT:m,TOKEN_FLOAT:h,TOKEN_BOOLEAN:w,TOKEN_NONE:I,TOKEN_SYMBOL:B,TOKEN_SPECIAL:U,TOKEN_REGEX:J}}),(function(M,S,N){"use strict";function y(P,K){P.prototype=Object.create(K.prototype),P.prototype.constructor=P,O(P,K)}function O(P,K){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(E,A){return E.__proto__=A,E},O(P,K)}var v=N(6),k=N(19),g=k.PrecompiledLoader,b=(function(P){y(K,P);function K(E,A){var e;return e=P.call(this)||this,e.baseURL=E||".",A=A||{},e.useCache=!!A.useCache,e.async=!!A.async,e}var F=K.prototype;return F.resolve=function(A,e){throw new Error("relative templates not support in the browser yet")},F.getSource=function(A,e){var o=this,n=this.useCache,f;return this.fetch(this.baseURL+"/"+A,function(u,p){if(u)if(e)e(u.content);else if(u.status===404)f=null;else throw u.content;else f={src:p,path:A,noCache:!n},o.emit("load",A,f),e&&e(null,f)}),f},F.fetch=function(A,e){if(typeof window>"u")throw new Error("WebLoader can only by used in a browser");var o=new XMLHttpRequest,n=!0;o.onreadystatechange=function(){o.readyState===4&&n&&(n=!1,o.status===0||o.status===200?e(null,o.responseText):e({status:o.status,content:o.responseText}))},A+=(A.indexOf("?")===-1?"?":"&")+"s="+new Date().getTime(),o.open("GET",A,this.async),o.send()},K})(v);M.exports={WebLoader:b,PrecompiledLoader:g}}),(function(M,S,N){"use strict";var y=N(0),O=N(7),v=O.Environment,k=O.Template,g=N(6),b=N(10),P=N(23),K=N(5),F=N(8),E=N(9),A=N(2),e=N(3),o=N(25),n;function f(u,p){p=p||{},y.isObject(u)&&(p=u,u=null);var i;return b.FileSystemLoader?i=new b.FileSystemLoader(u,{watch:p.watch,noCache:p.noCache}):b.WebLoader&&(i=new b.WebLoader(u,{useCache:p.web&&p.web.useCache,async:p.web&&p.web.async})),n=new v(i,p),p&&p.express&&n.express(p.express),n}M.exports={Environment:v,Template:k,Loader:g,FileSystemLoader:b.FileSystemLoader,NodeResolveLoader:b.NodeResolveLoader,PrecompiledLoader:b.PrecompiledLoader,WebLoader:b.WebLoader,compiler:K,parser:F,lexer:E,runtime:A,lib:y,nodes:e,installJinjaCompat:o,configure:f,reset:function(){n=void 0},compile:function(p,i,s,l){return n||f(),new k(p,i,s,l)},render:function(p,i,s){return n||f(),n.render(p,i,s)},renderString:function(p,i,s){return n||f(),n.renderString(p,i,s)},precompile:P?P.precompile:void 0,precompileString:P?P.precompileString:void 0}}),(function(M,S,N){"use strict";var y=N(13),O=[],v=[],k=y.makeRequestCallFromTimer(g);function g(){if(v.length)throw v.shift()}M.exports=b;function b(K){var F;O.length?F=O.pop():F=new P,F.task=K,y(F)}function P(){this.task=null}P.prototype.call=function(){try{this.task.call()}catch(K){b.onerror?b.onerror(K):(v.push(K),k())}finally{this.task=null,O[O.length]=this}}}),(function(M,S,N){"use strict";(function(y){M.exports=O;function O(o){v.length||(g(),k=!0),v[v.length]=o}var v=[],k=!1,g,b=0,P=1024;function K(){for(;b<v.length;){var o=b;if(b=b+1,v[o].call(),b>P){for(var n=0,f=v.length-b;n<f;n++)v[n]=v[n+b];v.length-=b,b=0}}v.length=0,b=0,k=!1}var F=typeof y<"u"?y:self,E=F.MutationObserver||F.WebKitMutationObserver;typeof E=="function"?g=A(K):g=e(K),O.requestFlush=g;function A(o){var n=1,f=new E(o),u=document.createTextNode("");return f.observe(u,{characterData:!0}),function(){n=-n,u.data=n}}function e(o){return function(){var f=setTimeout(p,0),u=setInterval(p,50);function p(){clearTimeout(f),clearInterval(u),o()}}}O.makeRequestCallFromTimer=e}).call(S,N(14))}),(function(M,S){var N;N=(function(){return this})();try{N=N||Function("return this")()||(0,eval)("this")}catch{typeof window=="object"&&(N=window)}M.exports=N}),(function(M,S,N){var y,O;(function(v){"use strict";var k=function(){var F=Array.prototype.slice.call(arguments);typeof F[0]=="function"&&F[0].apply(null,F.splice(1))},g=function(F){typeof setImmediate=="function"?setImmediate(F):typeof process<"u"&&process.nextTick?process.nextTick(F):setTimeout(F,0)},b=function(F){var E=function(A){var e=function(){return F.length&&F[A].apply(null,arguments),e.next()};return e.next=function(){return A<F.length-1?E(A+1):null},e};return E(0)},P=Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"},K=function(F,E,A){var e=A?g:k;if(E=E||function(){},!P(F)){var o=new Error("First argument to waterfall must be an array of functions");return E(o)}if(!F.length)return E();var n=function(f){return function(u){if(u)E.apply(null,arguments),E=function(){};else{var p=Array.prototype.slice.call(arguments,1),i=f.next();i?p.push(n(i)):p.push(E),e(function(){f.apply(null,p)})}}};n(b(F))()};y=[],O=(function(){return K}).apply(S,y),O!==void 0&&(M.exports=O)})(this)}),(function(M,S,N){"use strict";var y=typeof Reflect=="object"?Reflect:null,O=y&&typeof y.apply=="function"?y.apply:function(r,a,c){return Function.prototype.apply.call(r,a,c)},v;y&&typeof y.ownKeys=="function"?v=y.ownKeys:Object.getOwnPropertySymbols?v=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:v=function(r){return Object.getOwnPropertyNames(r)};function k(t){console&&console.warn&&console.warn(t)}var g=Number.isNaN||function(r){return r!==r};function b(){b.init.call(this)}M.exports=b,M.exports.once=i,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._eventsCount=0,b.prototype._maxListeners=void 0;var P=10;function K(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return P},set:function(t){if(typeof t!="number"||t<0||g(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");P=t}}),b.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||g(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function F(t){return t._maxListeners===void 0?b.defaultMaxListeners:t._maxListeners}b.prototype.getMaxListeners=function(){return F(this)},b.prototype.emit=function(r){for(var a=[],c=1;c<arguments.length;c++)a.push(arguments[c]);var _=r==="error",x=this._events;if(x!==void 0)_=_&&x.error===void 0;else if(!_)return!1;if(_){var T;if(a.length>0&&(T=a[0]),T instanceof Error)throw T;var L=new Error("Unhandled error."+(T?" ("+T.message+")":""));throw L.context=T,L}var R=x[r];if(R===void 0)return!1;if(typeof R=="function")O(R,this,a);else for(var m=R.length,h=f(R,m),c=0;c<m;++c)O(h[c],this,a);return!0};function E(t,r,a,c){var _,x,T;if(K(a),x=t._events,x===void 0?(x=t._events=Object.create(null),t._eventsCount=0):(x.newListener!==void 0&&(t.emit("newListener",r,a.listener?a.listener:a),x=t._events),T=x[r]),T===void 0)T=x[r]=a,++t._eventsCount;else if(typeof T=="function"?T=x[r]=c?[a,T]:[T,a]:c?T.unshift(a):T.push(a),_=F(t),_>0&&T.length>_&&!T.warned){T.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=t,L.type=r,L.count=T.length,k(L)}return t}b.prototype.addListener=function(r,a){return E(this,r,a,!1)},b.prototype.on=b.prototype.addListener,b.prototype.prependListener=function(r,a){return E(this,r,a,!0)};function A(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function e(t,r,a){var c={fired:!1,wrapFn:void 0,target:t,type:r,listener:a},_=A.bind(c);return _.listener=a,c.wrapFn=_,_}b.prototype.once=function(r,a){return K(a),this.on(r,e(this,r,a)),this},b.prototype.prependOnceListener=function(r,a){return K(a),this.prependListener(r,e(this,r,a)),this},b.prototype.removeListener=function(r,a){var c,_,x,T,L;if(K(a),_=this._events,_===void 0)return this;if(c=_[r],c===void 0)return this;if(c===a||c.listener===a)--this._eventsCount===0?this._events=Object.create(null):(delete _[r],_.removeListener&&this.emit("removeListener",r,c.listener||a));else if(typeof c!="function"){for(x=-1,T=c.length-1;T>=0;T--)if(c[T]===a||c[T].listener===a){L=c[T].listener,x=T;break}if(x<0)return this;x===0?c.shift():u(c,x),c.length===1&&(_[r]=c[0]),_.removeListener!==void 0&&this.emit("removeListener",r,L||a)}return this},b.prototype.off=b.prototype.removeListener,b.prototype.removeAllListeners=function(r){var a,c,_;if(c=this._events,c===void 0)return this;if(c.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):c[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete c[r]),this;if(arguments.length===0){var x=Object.keys(c),T;for(_=0;_<x.length;++_)T=x[_],T!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(a=c[r],typeof a=="function")this.removeListener(r,a);else if(a!==void 0)for(_=a.length-1;_>=0;_--)this.removeListener(r,a[_]);return this};function o(t,r,a){var c=t._events;if(c===void 0)return[];var _=c[r];return _===void 0?[]:typeof _=="function"?a?[_.listener||_]:[_]:a?p(_):f(_,_.length)}b.prototype.listeners=function(r){return o(this,r,!0)},b.prototype.rawListeners=function(r){return o(this,r,!1)},b.listenerCount=function(t,r){return typeof t.listenerCount=="function"?t.listenerCount(r):n.call(t,r)},b.prototype.listenerCount=n;function n(t){var r=this._events;if(r!==void 0){var a=r[t];if(typeof a=="function")return 1;if(a!==void 0)return a.length}return 0}b.prototype.eventNames=function(){return this._eventsCount>0?v(this._events):[]};function f(t,r){for(var a=new Array(r),c=0;c<r;++c)a[c]=t[c];return a}function u(t,r){for(;r+1<t.length;r++)t[r]=t[r+1];t.pop()}function p(t){for(var r=new Array(t.length),a=0;a<r.length;++a)r[a]=t[a].listener||t[a];return r}function i(t,r){return new Promise(function(a,c){function _(T){t.removeListener(r,x),c(T)}function x(){typeof t.removeListener=="function"&&t.removeListener("error",_),a([].slice.call(arguments))}l(t,r,x,{once:!0}),r!=="error"&&s(t,_,{once:!0})})}function s(t,r,a){typeof t.on=="function"&&l(t,"error",r,a)}function l(t,r,a,c){if(typeof t.on=="function")c.once?t.once(r,a):t.on(r,a);else if(typeof t.addEventListener=="function")t.addEventListener(r,function _(x){c.once&&t.removeEventListener(r,_),a(x)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}}),(function(M,S,N){"use strict";var y=N(3),O=N(0),v=0;function k(){return"hole_"+v++}function g(n,f){for(var u=null,p=0;p<n.length;p++){var i=f(n[p]);i!==n[p]&&(u||(u=n.slice()),u[p]=i)}return u||n}function b(n,f,u){if(!(n instanceof y.Node))return n;if(!u){var p=f(n);if(p&&p!==n)return p}if(n instanceof y.NodeList){var i=g(n.children,function(a){return b(a,f,u)});i!==n.children&&(n=new y[n.typename](n.lineno,n.colno,i))}else if(n instanceof y.CallExtension){var s=b(n.args,f,u),l=g(n.contentArgs,function(a){return b(a,f,u)});(s!==n.args||l!==n.contentArgs)&&(n=new y[n.typename](n.extName,n.prop,s,l))}else{var t=n.fields.map(function(a){return n[a]}),r=g(t,function(a){return b(a,f,u)});r!==t&&(n=new y[n.typename](n.lineno,n.colno),r.forEach(function(a,c){n[n.fields[c]]=a}))}return u&&f(n)||n}function P(n,f){return b(n,f,!0)}function K(n,f,u){var p=[],i=P(u?n[u]:n,function(s){var l;return s instanceof y.Block?s:((s instanceof y.Filter&&O.indexOf(f,s.name.value)!==-1||s instanceof y.CallExtensionAsync)&&(l=new y.Symbol(s.lineno,s.colno,k()),p.push(new y.FilterAsync(s.lineno,s.colno,s.name,s.args,l))),l)});return u?n[u]=i:n=i,p.length?(p.push(n),new y.NodeList(n.lineno,n.colno,p)):n}function F(n,f){return P(n,function(u){return u instanceof y.Output?K(u,f):u instanceof y.Set?K(u,f,"value"):u instanceof y.For?K(u,f,"arr"):u instanceof y.If?K(u,f,"cond"):u instanceof y.CallExtension?K(u,f,"args"):void 0})}function E(n){return b(n,function(f){if(f instanceof y.Block){var u=!1,p=k();f.body=b(f.body,function(i){if(i instanceof y.FunCall&&i.name.value==="super")return u=!0,new y.Symbol(i.lineno,i.colno,p)}),u&&f.body.children.unshift(new y.Super(0,0,f.name,new y.Symbol(0,0,p)))}})}function A(n){return P(n,function(f){if(!(!(f instanceof y.If)&&!(f instanceof y.For))){var u=!1;if(b(f,function(p){if(p instanceof y.FilterAsync||p instanceof y.IfAsync||p instanceof y.AsyncEach||p instanceof y.AsyncAll||p instanceof y.CallExtensionAsync)return u=!0,p}),u){if(f instanceof y.If)return new y.IfAsync(f.lineno,f.colno,f.cond,f.body,f.else_);if(f instanceof y.For&&!(f instanceof y.AsyncAll))return new y.AsyncEach(f.lineno,f.colno,f.arr,f.name,f.body,f.else_)}}})}function e(n,f){return A(E(F(n,f)))}function o(n,f){return e(n,f||[])}M.exports={transform:o}}),(function(M,v,N){"use strict";var y=N(0),O=N(2),v=M.exports={};function k(d,C){return d==null||d===!1?C:d}v.abs=Math.abs;function g(d){return d!==d}function b(d,C,D){var j,Y=[],z=[];for(j=0;j<d.length;j++)j%C===0&&z.length&&(Y.push(z),z=[]),z.push(d[j]);if(z.length){if(D)for(j=z.length;j<C;j++)z.push(D);Y.push(z)}return Y}v.batch=b;function P(d){d=k(d,"");var C=d.toLowerCase();return O.copySafeness(d,C.charAt(0).toUpperCase()+C.slice(1))}v.capitalize=P;function K(d,C){if(d=k(d,""),C=C||80,d.length>=C)return d;var D=C-d.length,j=y.repeat(" ",D/2-D%2),Y=y.repeat(" ",D/2);return O.copySafeness(d,j+d+Y)}v.center=K;function F(d,C,D){return D?d||C:d!==void 0?d:C}v.default=F;function E(d,C,D){if(!y.isObject(d))throw new y.TemplateError("dictsort filter: val must be an object");var j=[];for(var Y in d)j.push([Y,d[Y]]);var z;if(D===void 0||D==="key")z=0;else if(D==="value")z=1;else throw new y.TemplateError("dictsort filter: You can only sort by either key or value");return j.sort(function(re,Z){var se=re[z],he=Z[z];return C||(y.isString(se)&&(se=se.toUpperCase()),y.isString(he)&&(he=he.toUpperCase())),se>he?1:se===he?0:-1}),j}v.dictsort=E;function A(d,C){return JSON.stringify(d,null,C)}v.dump=A;function e(d){return d instanceof O.SafeString?d:(d=d??"",O.markSafe(y.escape(d.toString())))}v.escape=e;function o(d){return d instanceof O.SafeString?d:(d=d??"",O.markSafe(d.toString()))}v.safe=o;function n(d){return d[0]}v.first=n;function f(d){return d=d??"",O.markSafe(y.escape(d.toString()))}v.forceescape=f;function u(d,C){return y.groupBy(d,C,this.env.opts.throwOnUndefined)}v.groupby=u;function p(d,C,D){if(d=k(d,""),d==="")return"";C=C||4;var j=d.split(`
`),Y=y.repeat(" ",C),z=j.map(function(re,Z){return Z===0&&!D?re:""+Y+re}).join(`
`);return O.copySafeness(d,z)}v.indent=p;function i(d,C,D){return C=C||"",D&&(d=y.map(d,function(j){return j[D]})),d.join(C)}v.join=i;function s(d){return d[d.length-1]}v.last=s;function l(d){var C=k(d,"");return C!==void 0?typeof Map=="function"&&C instanceof Map||typeof Set=="function"&&C instanceof Set?C.size:y.isObject(C)&&!(C instanceof O.SafeString)?y.keys(C).length:C.length:0}v.length=l;function t(d){if(y.isString(d))return d.split("");if(y.isObject(d))return y._entries(d||{}).map(function(C){var D=C[0],j=C[1];return{key:D,value:j}});if(y.isArray(d))return d;throw new y.TemplateError("list filter: type not iterable")}v.list=t;function r(d){return d=k(d,""),d.toLowerCase()}v.lower=r;function a(d){return d==null?"":O.copySafeness(d,d.replace(/\r\n|\n/g,`<br />
`))}v.nl2br=a;function c(d){return d[Math.floor(Math.random()*d.length)]}v.random=c;function _(d){function C(D,j,Y){j===void 0&&(j="truthy");var z=this,re=z.env.getTest(j);return y.toArray(D).filter(function(se){return re.call(z,se,Y)===d})}return C}v.reject=_(!1);function x(d,C){return d.filter(function(D){return!D[C]})}v.rejectattr=x,v.select=_(!0);function T(d,C){return d.filter(function(D){return!!D[C]})}v.selectattr=T;function L(d,C,D,j){var Y=d;if(C instanceof RegExp)return d.replace(C,D);typeof j>"u"&&(j=-1);var z="";if(typeof C=="number")C=""+C;else if(typeof C!="string")return d;if(typeof d=="number"&&(d=""+d),typeof d!="string"&&!(d instanceof O.SafeString))return d;if(C==="")return z=D+d.split("").join(D)+D,O.copySafeness(d,z);var re=d.indexOf(C);if(j===0||re===-1)return d;for(var Z=0,se=0;re>-1&&(j===-1||se<j);)z+=d.substring(Z,re)+D,Z=re+C.length,se++,re=d.indexOf(C,Z);return Z<d.length&&(z+=d.substring(Z)),O.copySafeness(Y,z)}v.replace=L;function R(d){var C;return y.isString(d)?C=t(d):C=y.map(d,function(D){return D}),C.reverse(),y.isString(d)?O.copySafeness(d,C.join("")):C}v.reverse=R;function m(d,C,D){C=C||0;var j=Math.pow(10,C),Y;return D==="ceil"?Y=Math.ceil:D==="floor"?Y=Math.floor:Y=Math.round,Y(d*j)/j}v.round=m;function h(d,C,D){for(var j=Math.floor(d.length/C),Y=d.length%C,z=[],re=0,Z=0;Z<C;Z++){var se=re+Z*j;Z<Y&&re++;var he=re+(Z+1)*j,pe=d.slice(se,he);D&&Z>=Y&&pe.push(D),z.push(pe)}return z}v.slice=h;function w(d,C,D){return D===void 0&&(D=0),C&&(d=y.map(d,function(j){return j[C]})),D+d.reduce(function(j,Y){return j+Y},0)}v.sum=w,v.sort=O.makeMacro(["value","reverse","case_sensitive","attribute"],[],function(C,D,j,Y){var z=this,re=y.map(C,function(se){return se}),Z=y.getAttrGetter(Y);return re.sort(function(se,he){var pe=Y?Z(se):se,de=Y?Z(he):he;if(z.env.opts.throwOnUndefined&&Y&&(pe===void 0||de===void 0))throw new TypeError('sort: attribute "'+Y+'" resolved to undefined');return!j&&y.isString(pe)&&y.isString(de)&&(pe=pe.toLowerCase(),de=de.toLowerCase()),pe<de?D?1:-1:pe>de?D?-1:1:0}),re});function I(d){return O.copySafeness(d,d)}v.string=I;function B(d,C){d=k(d,"");var D=/<\/?([a-z][a-z0-9]*)\b[^>]*>|<!--[\s\S]*?-->/gi,j=J(d.replace(D,"")),Y="";return C?Y=j.replace(/^ +| +$/gm,"").replace(/ +/g," ").replace(/(\r\n)/g,`
`).replace(/\n\n\n+/g,`

`):Y=j.replace(/\s+/gi," "),O.copySafeness(d,Y)}v.striptags=B;function U(d){d=k(d,"");var C=d.split(" ").map(function(D){return P(D)});return O.copySafeness(d,C.join(" "))}v.title=U;function J(d){return O.copySafeness(d,d.replace(/^\s*|\s*$/g,""))}v.trim=J;function H(d,C,D,j){var Y=d;if(d=k(d,""),C=C||255,d.length<=C)return d;if(D)d=d.substring(0,C);else{var z=d.lastIndexOf(" ",C);z===-1&&(z=C),d=d.substring(0,z)}return d+=j??"...",O.copySafeness(Y,d)}v.truncate=H;function oe(d){return d=k(d,""),d.toUpperCase()}v.upper=oe;function ae(d){var C=encodeURIComponent;if(y.isString(d))return C(d);var D=y.isArray(d)?d:y._entries(d);return D.map(function(j){var Y=j[0],z=j[1];return C(Y)+"="+C(z)}).join("&")}v.urlencode=ae;var X=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,Q=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,V=/^https?:\/\/.*$/,W=/^www\./,G=/\.(?:org|net|com)(?:\:|\/|$)/;function ne(d,C,D){g(C)&&(C=1/0);var j=D===!0?' rel="nofollow"':"",Y=d.split(/(\s+)/).filter(function(z){return z&&z.length}).map(function(z){var re=z.match(X),Z=re?re[1]:z,se=Z.substr(0,C);return V.test(Z)?'<a href="'+Z+'"'+j+">"+se+"</a>":W.test(Z)?'<a href="http://'+Z+'"'+j+">"+se+"</a>":Q.test(Z)?'<a href="mailto:'+Z+'">'+Z+"</a>":G.test(Z)?'<a href="http://'+Z+'"'+j+">"+se+"</a>":z});return Y.join("")}v.urlize=ne;function ue(d){d=k(d,"");var C=d?d.match(/\w+/g):null;return C?C.length:null}v.wordcount=ue;function ce(d,C){var D=parseFloat(d);return g(D)?C:D}v.float=ce;var ve=O.makeMacro(["value","default","base"],[],function(C,D,j){j===void 0&&(j=10);var Y=parseInt(C,j);return g(Y)?D:Y});v.int=ve,v.d=v.default,v.e=v.escape}),(function(M,S,N){"use strict";function y(g,b){g.prototype=Object.create(b.prototype),g.prototype.constructor=g,O(g,b)}function O(g,b){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(K,F){return K.__proto__=F,K},O(g,b)}var v=N(6),k=(function(g){y(b,g);function b(K){var F;return F=g.call(this)||this,F.precompiled=K||{},F}var P=b.prototype;return P.getSource=function(F){return this.precompiled[F]?{src:{type:"code",obj:this.precompiled[F]},path:F}:null},b})(v);M.exports={PrecompiledLoader:k}}),(function(M,S,N){"use strict";var y=N(2).SafeString;function O(c){return typeof c=="function"}S.callable=O;function v(c){return c!==void 0}S.defined=v;function k(c,_){return c%_===0}S.divisibleby=k;function g(c){return c instanceof y}S.escaped=g;function b(c,_){return c===_}S.equalto=b,S.eq=S.equalto,S.sameas=S.equalto;function P(c){return c%2===0}S.even=P;function K(c){return!c}S.falsy=K;function F(c,_){return c>=_}S.ge=F;function E(c,_){return c>_}S.greaterthan=E,S.gt=S.greaterthan;function A(c,_){return c<=_}S.le=A;function e(c,_){return c<_}S.lessthan=e,S.lt=S.lessthan;function o(c){return c.toLowerCase()===c}S.lower=o;function n(c,_){return c!==_}S.ne=n;function f(c){return c===null}S.null=f;function u(c){return typeof c=="number"}S.number=u;function p(c){return c%2===1}S.odd=p;function i(c){return typeof c=="string"}S.string=i;function s(c){return!!c}S.truthy=s;function l(c){return c===void 0}S.undefined=l;function t(c){return c.toUpperCase()===c}S.upper=t;function r(c){return typeof Symbol<"u"?!!c[Symbol.iterator]:Array.isArray(c)||typeof c=="string"}S.iterable=r;function a(c){var _=c!=null&&typeof c=="object"&&!Array.isArray(c);return Set?_&&!(c instanceof Set):_}S.mapping=a}),(function(M,S,N){"use strict";function y(k){var g=-1;return{current:null,reset:function(){g=-1,this.current=null},next:function(){return g++,g>=k.length&&(g=0),this.current=k[g],this.current}}}function O(k){k=k||",";var g=!0;return function(){var b=g?"":k;return g=!1,b}}function v(){return{range:function(g,b,P){typeof b>"u"?(b=g,g=0,P=1):P||(P=1);var K=[];if(P>0)for(var F=g;F<b;F+=P)K.push(F);else for(var E=g;E>b;E+=P)K.push(E);return K},cycler:function(){return y(Array.prototype.slice.call(arguments))},joiner:function(g){return O(g)}}}M.exports=v}),(function(M,S,N){var y=N(4);M.exports=function(v,k){function g(b,P){if(this.name=b,this.path=b,this.defaultEngine=P.defaultEngine,this.ext=y.extname(b),!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=(this.defaultEngine[0]!=="."?".":"")+this.defaultEngine)}return g.prototype.render=function(P,K){v.render(this.name,P,K)},k.set("view",g),k.set("nunjucksEnv",v),v}}),(function(M,S,N){"use strict";var y=N(4),O=N(4),v=N(0),k=v._prettifyError,g=N(5),b=N(7),P=b.Environment,K=N(24);function F(o,n){return Array.isArray(n)?n.some(function(f){return o.match(f)}):!1}function E(o,n){n=n||{},n.isString=!0;var f=n.env||new P([]),u=n.wrapper||K;if(!n.name)throw new Error('the "name" option is required when compiling a string');return u([e(o,n.name,f)],n)}function A(o,n){n=n||{};var f=n.env||new P([]),u=n.wrapper||K;if(n.isString)return E(o,n);var p=y.existsSync(o)&&y.statSync(o),i=[],s=[];function l(a){y.readdirSync(a).forEach(function(c){var _=O.join(a,c),x=_.substr(O.join(o,"/").length),T=y.statSync(_);T&&T.isDirectory()?(x+="/",F(x,n.exclude)||l(_)):F(x,n.include)&&s.push(_)})}if(p.isFile())i.push(e(y.readFileSync(o,"utf-8"),n.name||o,f));else if(p.isDirectory()){l(o);for(var t=0;t<s.length;t++){var r=s[t].replace(O.join(o,"/"),"");try{i.push(e(y.readFileSync(s[t],"utf-8"),r,f))}catch(a){if(n.force)console.error(a);else throw a}}}return u(i,n)}function e(o,n,f){f=f||new P([]);var u=f.asyncFilters,p=f.extensionsList,i;n=n.replace(/\\/g,"/");try{i=g.compile(o,u,p,n,f.opts)}catch(s){throw k(n,!1,s)}return{name:n,template:i}}M.exports={precompile:A,precompileString:E}}),(function(M,S,N){"use strict";function y(O,v){var k="";v=v||{};for(var g=0;g<O.length;g++){var b=JSON.stringify(O[g].name),P=O[g].template;k+="(function() {(window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["+b+`] = (function() {
`+P+`
})();
`,v.asFunction&&(k+="return function(ctx, cb) { return nunjucks.render("+b+`, ctx, cb); }
`),k+=`})();
`}return k}M.exports=y}),(function(M,S,N){function y(){"use strict";var O=this.runtime,v=this.lib,k=this.compiler.Compiler,g=this.parser.Parser,b=this.nodes,P=this.lexer,K=O.contextOrFrameLookup,F=O.memberLookup,E,A;k&&(E=k.prototype.assertType),g&&(A=g.prototype.parseAggregate);function e(){O.contextOrFrameLookup=K,O.memberLookup=F,k&&(k.prototype.assertType=E),g&&(g.prototype.parseAggregate=A)}O.contextOrFrameLookup=function(l,t,r){var a=K.apply(this,arguments);if(a!==void 0)return a;switch(r){case"True":return!0;case"False":return!1;case"None":return null;default:return}};function o(s){return{index:s.index,lineno:s.lineno,colno:s.colno}}if(b&&k&&g){var n=b.Node.extend("Slice",{fields:["start","stop","step"],init:function(l,t,r,a,c){r=r||new b.Literal(l,t,null),a=a||new b.Literal(l,t,null),c=c||new b.Literal(l,t,1),this.parent(l,t,r,a,c)}});k.prototype.assertType=function(l){l instanceof n||E.apply(this,arguments)},k.prototype.compileSlice=function(l,t){this._emit("("),this._compileExpression(l.start,t),this._emit("),("),this._compileExpression(l.stop,t),this._emit("),("),this._compileExpression(l.step,t),this._emit(")")},g.prototype.parseAggregate=function(){var l=this,t=o(this.tokens);t.colno--,t.index--;try{return A.apply(this)}catch(R){var r=o(this.tokens),a=function(){return v._assign(l.tokens,r),R};v._assign(this.tokens,t),this.peeked=!1;var c=this.peekToken();if(c.type!==P.TOKEN_LEFT_BRACKET)throw a();this.nextToken();for(var _=new n(c.lineno,c.colno),x=!1,T=0;T<=_.fields.length&&!this.skip(P.TOKEN_RIGHT_BRACKET);T++){if(T===_.fields.length)if(x)this.fail("parseSlice: too many slice components",c.lineno,c.colno);else break;if(this.skip(P.TOKEN_COLON))x=!0;else{var L=_.fields[T];_[L]=this.parseExpression(),x=this.skip(P.TOKEN_COLON)||x}}if(!x)throw a();return new b.Array(c.lineno,c.colno,[_])}}}function f(s,l,t,r){s=s||[],l===null&&(l=r<0?s.length-1:0),t===null?t=r<0?-1:s.length:t<0&&(t+=s.length),l<0&&(l+=s.length);for(var a=[],c=l;!(c<0||c>s.length||r>0&&c>=t||r<0&&c<=t);c+=r)a.push(O.memberLookup(s,c));return a}function u(s,l){return Object.prototype.hasOwnProperty.call(s,l)}var p={pop:function(l){if(l===void 0)return this.pop();if(l>=this.length||l<0)throw new Error("KeyError");return this.splice(l,1)},append:function(l){return this.push(l)},remove:function(l){for(var t=0;t<this.length;t++)if(this[t]===l)return this.splice(t,1);throw new Error("ValueError")},count:function(l){for(var t=0,r=0;r<this.length;r++)this[r]===l&&t++;return t},index:function(l){var t;if((t=this.indexOf(l))===-1)throw new Error("ValueError");return t},find:function(l){return this.indexOf(l)},insert:function(l,t){return this.splice(l,0,t)}},i={items:function(){return v._entries(this)},values:function(){return v._values(this)},keys:function(){return v.keys(this)},get:function(l,t){var r=this[l];return r===void 0&&(r=t),r},has_key:function(l){return u(this,l)},pop:function(l,t){var r=this[l];if(r===void 0&&t!==void 0)r=t;else{if(r===void 0)throw new Error("KeyError");delete this[l]}return r},popitem:function(){var l=v.keys(this);if(!l.length)throw new Error("KeyError");var t=l[0],r=this[t];return delete this[t],[t,r]},setdefault:function(l,t){return t===void 0&&(t=null),l in this||(this[l]=t),this[l]},update:function(l){return v._assign(this,l),null}};return i.iteritems=i.items,i.itervalues=i.values,i.iterkeys=i.keys,O.memberLookup=function(l,t,r){return arguments.length===4?f.apply(this,arguments):(l=l||{},v.isArray(l)&&u(p,t)?p[t].bind(l):v.isObject(l)&&u(i,t)?i[t].bind(l):F.apply(this,arguments))},e}M.exports=y})])})});var be=Ye(Ce(),1);var ye=["personal-section","purchase-section","fuel-section","insurance-section","maintenance-section","cost-breakdown"],me=0;function Fe(){let M=document.querySelectorAll("#progress-stepper button"),S=document.querySelector("#stepper-next"),N=document.querySelector("#stepper-previous");M.forEach(y=>{y.addEventListener("click",()=>{let O=y.getAttribute("data-target");Se(O)})}),S.addEventListener("click",ze),N.addEventListener("click",Je)}function ze(){if(me<ye.length-1){let M=document.querySelector(`#${ye[me]}`),S=document.querySelector(`#${ye[me+1]}`);me++,Ae(M,S)}}function Je(){if(me>0){let M=document.querySelector(`#${ye[me]}`),S=document.querySelector(`#${ye[me-1]}`);me--,Ae(M,S)}}function Se(M){let S=ye.indexOf(M),N=document.querySelector(`#${ye[me]}`),y=document.querySelector(`#${M}`);me=S,Ae(N,y)}function Xe(){let M=document.querySelector("#progress-stepper button.active-step"),S=document.querySelector(`#progress-stepper button[data-target=${ye[me]}]`);M.classList.remove("active-step"),S.classList.add("active-step")}function Ae(M,S){M.classList.add("hidden"),S.classList.remove("hidden"),Xe()}(()=>{let M={miles:{name:"miles",abbreviation:"mi."},kilometers:{name:"kilometers",abbreviation:"km."},gallons:{name:"gallons",abbreviation:"gal."},litres:{name:"litres",abbreviation:"L"},kilowatt_hours:{name:"kilowatt-hours",abbreviation:"kWh"},dollars:{symbol:"$",code:"USD"},euros:{symbol:"\u20AC",code:"EUR"},yen:{symbol:"\xA5",code:"JPY"},pounds:{symbol:"\xA3",code:"GBP"}};var S={},N={vehicleTotal:0,loanMonthlyCost:0,loanVehicleTotal:0,monthlyExpenses:0},y={distance:M.miles,volume:M.gallons,currency:M.dollars,energy:M.kilowatt_hours},O=new Intl.NumberFormat("en-US",{style:"currency",currency:y.currency.code});window.addEventListener("load",t=>{v(),k()});function v(){be.default.configure("templates"),[{selector:"form",event:"submit",function:g},{selector:"#financing-cash",event:"click",function:b},{selector:"#financing-loan",event:"click",function:b},{selector:"#fuel-type-combustion",event:"click",function:P},{selector:"#fuel-type-electric",event:"click",function:P},{selector:"#down-payment-one",event:"keyup",function:K},{selector:"#down-payment-two",event:"keyup",function:K},{selector:"#electric-efficiency-one",event:"keyup",function:F},{selector:"#electric-efficiency-two",event:"keyup",function:F},{selector:"#combustion-efficiency-one",event:"keyup",function:E},{selector:"#combustion-efficiency-two",event:"keyup",function:E},{selector:"#loan-terms-other",event:"keyup",function:e},{selector:"#annual-insurance-one",event:"keyup",function:A},{selector:"#annual-insurance-two",event:"keyup",function:A}].forEach(a=>{let c=a.selector,_=a.event,x=a.function;document.querySelector(c).addEventListener(_,x)});let r=document.forms[0];r.querySelectorAll("input").forEach(a=>{let c=a.type==="radio"||a.type==="checkbox",_=a.type==="number"||a.type==="text";if(c){a.addEventListener("click",k);return}if(_){a.addEventListener("keyup",k),a.addEventListener("focus",()=>a.select());return}}),r.querySelectorAll("select.preference").forEach(a=>{a.addEventListener("change",()=>{let c=a.id.replace("preference-",""),_=a.value;switch(y[c]=M[_],c){case"distance":['label[for="combustion-efficiency-one"] span.distance-value','label[for="combustion-efficiency-two"] span.distance-value','label[for="electric-efficiency-one"] span.distance-value','label[for="electric-efficiency-two"] span.distance-value'].forEach(x=>{document.querySelector(x).innerText=y.distance.abbreviation});case"volume":['label[for="combustion-efficiency-one"] span.volume-value','label[for="combustion-efficiency-two"] span.volume-value','label[for="gas-price"] span.volume-value'].forEach(x=>{document.querySelector(x).innerText=y.volume.abbreviation});case"currency":O=new Intl.NumberFormat("en-US",{style:"currency",currency:y.currency.code}),['label[for="down-payment-one"]'].forEach(x=>{document.querySelector(x).innerText=y.currency.symbol});break}k()})}),Fe()}function k(){try{o(),p()}catch(t){console.log("Results Error"),console.log(t)}}function g(t){t.preventDefault(),k(),Se("cost-breakdown")}function b(t){let r=document.getElementById("financing-options");t.target.value==="cash"?r.classList.add("hidden"):r.classList.remove("hidden")}function P(t){let r=document.getElementById("combustion-options"),a=document.getElementById("electric-options");t.target.value==="combustion"?(a.classList.add("hidden"),r.classList.remove("hidden")):(a.classList.remove("hidden"),r.classList.add("hidden"))}function K(t){try{let r=document.querySelector("#asking-price").value;if(Number(r)==0)return;if(t.target.id==="down-payment-one"){let a=document.querySelector("#down-payment-one").value;if(Number(a)==0)return;document.querySelector("#down-payment-two").value=Number((a/r*100).toFixed(2))}else{let a=document.querySelector("#down-payment-two").value;if(Number(a)==0)return;document.querySelector("#down-payment-one").value=Number((a/100*r).toFixed(2))}}catch(r){console.log(`An error occurred calculating the down payment: ${r}`)}}function F(t){try{if(t.target.id==="electric-efficiency-one"){let r=t.target.value;document.querySelector("#electric-efficiency-two").value=Number((1/r*100).toFixed(2))}else{let r=t.target.value;document.querySelector("#electric-efficiency-one").value=Number((100/r).toFixed(2))}}catch(r){console.log(`An error occurred calculating EV efficiency: ${r}`)}}function E(t){try{if(t.target.id==="combustion-efficiency-one"){let r=t.target.value;document.querySelector("#combustion-efficiency-two").value=Number((1/r*100).toFixed(2))}else{let r=t.target.value;document.querySelector("#combustion-efficiency-one").value=Number((100/r).toFixed(2))}}catch(r){console.log(`An error occurred calculating ICE vehicle efficiency: ${r}`)}}function A(t){try{if(t.target.id==="annual-insurance-one"){let r=document.querySelector("#annual-insurance-one").value;document.querySelector("#annual-insurance-two").value=Math.round(r/12)}else{let r=document.querySelector("#annual-insurance-two").value;document.querySelector("#annual-insurance-one").value=Math.round(r*12)}}catch(r){console.log(`An error occurred calculating insurance cost: ${r}`)}}function e(t){document.querySelectorAll('input[name="loan-terms"]').forEach(r=>{r.checked=!1})}function o(){let t=document.forms[0];for(let r=0;r<t.elements.length;r++){let a=t.elements[r];a.value&&a.type!=="radio"&&a.type!=="checkbox"?S[a.id]=a.value:a.name==="loan-terms"&&a.checked&&(S["loan-terms"]=a.value)}S["paying-cash"]=document.getElementById("financing-cash").checked,S["combustion-fuel"]=document.getElementById("fuel-type-combustion").checked}function n(t){return t?Number(t):0}function f(t){return O.format(t)}function u(t){let r=document.querySelector("#warning-alert");r.querySelector("p").innerHTML=t,r.classList.remove("hidden"),setTimeout(()=>{r.classList.contains("hidden")||r.classList.add("hidden")},1e4)}function p(){let t=n(S["down-payment-one"]),r=n(S["asking-price"]),a=n(S["trade-in"]);if(a>=r){u("The trade-in value must be less than the asking price.");return}if(t>=r-a){u("The down payment must be less than the asking price minus the trade-in.");return}i(),s(),l()}function i(){let t={isPayingCash:S["paying-cash"]},r=n(S["asking-price"]),a=n(S.fees),c=n(S["sales-tax"])/100,_=n(S["tags-title"]),x=n(S["trade-in"]),T=n(S["down-payment-one"]),L=S["loan-terms-other"]?Number(S["loan-terms-other"]):n(S["loan-terms"]),R=n(S.apr)/100,m=R/12,h=r-x,w=h*c,I=h+w+a+_,B=h-T,U=h*c,J=B+U,H=J*L*m/(1-Math.pow(1+m,-L)),oe=H+T+a+_,ae=H-J;t.cashTotal=f(I),t.fees=f(a),t.tradeIn=`-${f(x)}`,t.cashTax=f(w),t.loanTax=f(U),t.taxRate=`${(c*100).toFixed(1)}%`,t.tags=f(_),t.loanTotal=f(oe),t.principal=f(J),t.price=f(r),t.downPayment=`-${f(T)}`,t.interest=f(ae),t.apr=`${(R*100).toFixed(1)}%`,t.terms=`${L} months`,N.vehicleTotal=I,N.loanVehicleTotal=oe;let X=document.getElementById("total-vehicle-cost-table");X.innerHTML=be.default.render("total-vehicle-cost/index.html",t)}function s(){let t={},r=n(S["annual-insurance-one"]),a=n(S["annual-mileage"]),c=n(S["annual-maintenance"]),_=n(S["annual-repair"]),x=y.distance,T,L,R,m,h,w;S["combustion-fuel"]?(L=n(S["combustion-efficiency-one"]),m=n(S["gas-price"]),h=Math.round(a/L),w=h*m,T=y.volume):(L=n(S["electric-efficiency-one"]),m=n(S["electricity-price"]),h=Math.round(a/L),w=h*m,T=y.energy),R=`${x.abbreviation}/${T.abbreviation}`;let B=r+c+_+w,U=B/12;t.expenses=f(B),t.fuel=f(w),t.fuelUsed=h.toLocaleString(),t.annualMilage=a.toLocaleString(),t.efficiency=L,t.fuelPrice=f(m),t.insurance=f(r),t.maintenance=f(c),t.repairs=f(_),t.efficiencyUnits=R,t.distanceUnit=x,t.fuelUnit=T,N.monthlyExpenses=U;let J=document.getElementById("monthly-expenses-cost-table");J.innerHTML=be.default.render("additional-annual-expenses/index.html",t)}function l(){let t={},r=n(S["annual-income"]),a=n(S["ownership-time"]),c=N.monthlyExpenses;if(S["paying-cash"]){let x=N.vehicleTotal+a*c,T=Math.round(c*12/r*100),L=`<small>(after ${a} years)</small>`;t={paymentType:"Paid with Cash",cost:`${f(x)} ${L}`,monthlyCost:f(c),incomeShare:T}}else{let x=S["loan-terms-other"]?Number(S["loan-terms-other"]):n(S["loan-terms"]),T=N.loanVehicleTotal/x,L=c+T,R=N.loanVehicleTotal+a*c,m=Math.round(L*12/r*100),h=x/12-a<=0?`<small>(after ${a} years)</small>`:`<small>(after ${a} years; ${x/12-a} years left on loan)</small>`;t={paymentType:"Paid with a Loan",cost:`${f(R)} ${h}`,monthlyCost:f(L),incomeShare:m}}let _=document.getElementById("cost-summary");_.innerHTML=be.default.render("cost-summary/index.html",t)}})();})();
/*! Bundled license information:

nunjucks/browser/nunjucks.js:
  (*! Browser bundle of nunjucks 3.2.4  *)
*/
//# sourceMappingURL=main.js.map
